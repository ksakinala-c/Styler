var Card;!function(e){"use strict";Card=Backbone.RelationalModel.extend({relations:[{type:"HasMany",key:"accessories",relatedModel:"Accessory"}],initialize:function(e){Backbone.RelationalModel.prototype.initialize.call(this,e),this.availableAccessories=e.availableAccessories,this.listenTo(this.get("accessories"),"add remove change",this.render)},render:function(){e("input[name=accessory_codes]").val(this.get("accessories").pluck("code").join("|"))},addAccessoryByCode:function(e){var s=this.availableAccessories.get(e);this._clearByCategory(s.get("category")),this.get("accessories").set([s],{remove:!1})},toggleAccessoryByCode:function(e){this.get("accessories").get(e)?this.removeAccessoryByCode(e):this.addAccessoryByCode(e)},removeAccessoryByCode:function(e){var s=this.availableAccessories.get(e);s&&this.get("accessories").remove(s)},_clearByCategory:function(e){var s=this.get("accessories"),c=s.where({category:e});_.each(c,function(e){s.remove(e)},this)}})}(jQuery);