(function(){function e(e,t,n){n=(n||0)-1;for(var i=e?e.length:0;++n<i;)if(e[n]===t)return n;return-1}function t(t,n){var i=typeof n;if(t=t.l,"boolean"==i||null==n)return t[n]?0:-1;"number"!=i&&"string"!=i&&(i="object");var o="number"==i?n:y+n;return t=(t=t[i])&&t[o],"object"==i?t&&-1<e(t,n)?0:-1:t?0:-1}function n(e){var t=this.l,n=typeof e;if("boolean"==n||null==e)t[e]=!0;else{"number"!=n&&"string"!=n&&(n="object");var i="number"==n?e:y+e,t=t[n]||(t[n]={});"object"==n?(t[i]||(t[i]=[])).push(e):t[i]=!0}}function i(e){return e.charCodeAt(0)}function o(e,t){for(var n=e.m,i=t.m,o=-1,r=n.length;++o<r;){var s=n[o],a=i[o];if(s!==a){if(s>a||"undefined"==typeof s)return 1;if(a>s||"undefined"==typeof a)return-1}}return e.n-t.n}function r(e){var t=-1,i=e.length,o=e[0],r=e[i/2|0],s=e[i-1];if(o&&"object"==typeof o&&r&&"object"==typeof r&&s&&"object"==typeof s)return!1;for(o=l(),o["false"]=o["null"]=o["true"]=o.undefined=!1,r=l(),r.k=e,r.l=o,r.push=n;++t<i;)r.push(e[t]);return r}function s(e){return"\\"+Q[e]}function a(){return p.pop()||[]}function l(){return g.pop()||{k:null,l:null,m:null,"false":!1,n:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,o:null}}function u(e){e.length=0,p.length<b&&p.push(e)}function c(e){var t=e.l;t&&c(t),e.k=e.l=e.m=e.object=e.number=e.string=e.o=null,g.length<b&&g.push(e)}function f(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);var i=-1;n=n-t||0;for(var o=Array(0>n?0:n);++i<n;)o[i]=e[t+i];return o}function h(n){function p(e,t,n){if(!e||!J[typeof e])return e;t=t&&"undefined"==typeof n?t:te(t,n,3);for(var i=-1,o=J[typeof e]&&Dt(e),r=o?o.length:0;++i<r&&(n=o[i],!1!==t(e[n],n,e)););return e}function g(e,t,n){var i;if(!e||!J[typeof e])return e;t=t&&"undefined"==typeof n?t:te(t,n,3);for(i in e)if(!1===t(e[i],i,e))break;return e}function b(e,t,n){var i,o=e,r=o;if(!o)return r;for(var s=arguments,a=0,l="number"==typeof n?2:s.length;++a<l;)if((o=s[a])&&J[typeof o])for(var u=-1,c=J[typeof o]&&Dt(o),f=c?c.length:0;++u<f;)i=c[u],"undefined"==typeof r[i]&&(r[i]=o[i]);return r}function Q(e,t,n){var i,o=e,r=o;if(!o)return r;var s=arguments,a=0,l="number"==typeof n?2:s.length;if(l>3&&"function"==typeof s[l-2])var u=te(s[--l-1],s[l--],2);else l>2&&"function"==typeof s[l-1]&&(u=s[--l]);for(;++a<l;)if((o=s[a])&&J[typeof o])for(var c=-1,f=J[typeof o]&&Dt(o),h=f?f.length:0;++c<h;)i=f[c],r[i]=u?u(r[i],o[i]):o[i];return r}function K(e){var t,n=[];if(!e||!J[typeof e])return n;for(t in e)yt.call(e,t)&&n.push(t);return n}function W(e){return e&&"object"==typeof e&&!zt(e)&&yt.call(e,"__wrapped__")?e:new X(e)}function X(e,t){this.__chain__=!!t,this.__wrapped__=e}function V(e){function t(){if(i){var e=f(i);mt.apply(e,arguments)}if(this instanceof t){var r=ee(n.prototype),e=n.apply(r,e||arguments);return _e(e)?e:r}return n.apply(o,e||arguments)}var n=e[0],i=e[2],o=e[4];return Pt(t,e),t}function Z(e,t,n,i,o){if(n){var r=n(e);if("undefined"!=typeof r)return r}if(!_e(e))return e;var s=ct.call(e);if(!q[s])return e;var l=Et[s];switch(s){case z:case D:return new l(+e);case F:case H:return new l(e);case B:return r=l(e.source,R.exec(e)),r.lastIndex=e.lastIndex,r}if(s=zt(e),t){var c=!i;i||(i=a()),o||(o=a());for(var h=i.length;h--;)if(i[h]==e)return o[h];r=s?l(e.length):{}}else r=s?f(e):Q({},e);return s&&(yt.call(e,"index")&&(r.index=e.index),yt.call(e,"input")&&(r.input=e.input)),t?(i.push(e),o.push(r),(s?Ie:p)(e,function(e,s){r[s]=Z(e,t,n,i,o)}),c&&(u(i),u(o)),r):r}function ee(e){return _e(e)?Ct(e):{}}function te(e,t,n){if("function"!=typeof e)return Qe;if("undefined"==typeof t||!("prototype"in e))return e;var i=e.__bindData__;if("undefined"==typeof i&&(At.funcNames&&(i=!e.name),i=i||!At.funcDecomp,!i)){var o=gt.call(e);At.funcNames||(i=!j.test(o)),i||(i=O.test(o),Pt(e,i))}if(!1===i||!0!==i&&1&i[1])return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,o){return e.call(t,n,i,o)};case 4:return function(n,i,o,r){return e.call(t,n,i,o,r)}}return Le(e,t)}function ne(e){function t(){var e=l?s:this;if(o){var p=f(o);mt.apply(p,arguments)}return(r||c)&&(p||(p=f(arguments)),r&&mt.apply(p,r),c&&p.length<a)?(i|=16,ne([n,h?i:-4&i,p,null,s,a])):(p||(p=arguments),u&&(n=e[d]),this instanceof t?(e=ee(n.prototype),p=n.apply(e,p),_e(p)?p:e):n.apply(e,p))}var n=e[0],i=e[1],o=e[2],r=e[3],s=e[4],a=e[5],l=1&i,u=2&i,c=4&i,h=8&i,d=n;return Pt(t,e),t}function ie(n,i){var o=-1,s=he(),a=n?n.length:0,l=a>=m&&s===e,u=[];if(l){var f=r(i);f?(s=t,i=f):l=!1}for(;++o<a;)f=n[o],0>s(i,f)&&u.push(f);return l&&c(i),u}function oe(e,t,n,i){i=(i||0)-1;for(var o=e?e.length:0,r=[];++i<o;){var s=e[i];if(s&&"object"==typeof s&&"number"==typeof s.length&&(zt(s)||ve(s))){t||(s=oe(s,t,n));var a=-1,l=s.length,u=r.length;for(r.length+=l;++a<l;)r[u++]=s[a]}else n||r.push(s)}return r}function re(e,t,n,i,o,r){if(n){var s=n(e,t);if("undefined"!=typeof s)return!!s}if(e===t)return 0!==e||1/e==1/t;if(e===e&&!(e&&J[typeof e]||t&&J[typeof t]))return!1;if(null==e||null==t)return e===t;var l=ct.call(e),c=ct.call(t);if(l==A&&(l=G),c==A&&(c=G),l!=c)return!1;switch(l){case z:case D:return+e==+t;case F:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case B:case H:return e==rt(t)}if(c=l==P,!c){var f=yt.call(e,"__wrapped__"),h=yt.call(t,"__wrapped__");if(f||h)return re(f?e.__wrapped__:e,h?t.__wrapped__:t,n,i,o,r);if(l!=G)return!1;if(l=e.constructor,f=t.constructor,l!=f&&!(we(l)&&l instanceof l&&we(f)&&f instanceof f)&&"constructor"in e&&"constructor"in t)return!1}for(l=!o,o||(o=a()),r||(r=a()),f=o.length;f--;)if(o[f]==e)return r[f]==t;var d=0,s=!0;if(o.push(e),r.push(t),c){if(f=e.length,d=t.length,(s=d==f)||i)for(;d--;)if(c=f,h=t[d],i)for(;c--&&!(s=re(e[c],h,n,i,o,r)););else if(!(s=re(e[d],h,n,i,o,r)))break}else g(t,function(t,a,l){return yt.call(l,a)?(d++,s=yt.call(e,a)&&re(e[a],t,n,i,o,r)):void 0}),s&&!i&&g(e,function(e,t,n){return yt.call(n,t)?s=-1<--d:void 0});return o.pop(),r.pop(),l&&(u(o),u(r)),s}function se(e,t,n,i,o){(zt(t)?Ie:p)(t,function(t,r){var s,a,l=t,u=e[r];if(t&&((a=zt(t))||Ht(t))){for(l=i.length;l--;)if(s=i[l]==t){u=o[l];break}if(!s){var c;n&&(l=n(u,t),c="undefined"!=typeof l)&&(u=l),c||(u=a?zt(u)?u:[]:Ht(u)?u:{}),i.push(t),o.push(u),c||se(u,t,n,i,o)}}else n&&(l=n(u,t),"undefined"==typeof l&&(l=t)),"undefined"!=typeof l&&(u=l);e[r]=u})}function ae(e,t){return e+pt(Tt()*(t-e+1))}function le(n,i,o){var s=-1,l=he(),f=n?n.length:0,h=[],d=!i&&f>=m&&l===e,p=o||d?a():h;for(d&&(p=r(p),l=t);++s<f;){var g=n[s],v=o?o(g,s,n):g;(i?!s||p[p.length-1]!==v:0>l(p,v))&&((o||d)&&p.push(v),h.push(g))}return d?(u(p.k),c(p)):o&&u(p),h}function ue(e){return function(t,n,i){var o={};n=W.createCallback(n,i,3),i=-1;var r=t?t.length:0;if("number"==typeof r)for(;++i<r;){var s=t[i];e(o,s,n(s,i,t),t)}else p(t,function(t,i,r){e(o,t,n(t,i,r),r)});return o}}function ce(e,t,n,i,o,r){var s=1&t,a=4&t,l=16&t,u=32&t;if(!(2&t||we(e)))throw new st;l&&!n.length&&(t&=-17,l=n=!1),u&&!i.length&&(t&=-33,u=i=!1);var c=e&&e.__bindData__;return c&&!0!==c?(c=f(c),c[2]&&(c[2]=f(c[2])),c[3]&&(c[3]=f(c[3])),!s||1&c[1]||(c[4]=o),!s&&1&c[1]&&(t|=8),!a||4&c[1]||(c[5]=r),l&&mt.apply(c[2]||(c[2]=[]),n),u&&_t.apply(c[3]||(c[3]=[]),i),c[1]|=t,ce.apply(null,c)):(1==t||17===t?V:ne)([e,t,n,i,o,r])}function fe(e){return Nt[e]}function he(){var t=(t=W.indexOf)===Fe?e:t;return t}function de(e){return"function"==typeof e&&ft.test(e)}function pe(e){var t,n;return e&&ct.call(e)==G&&(t=e.constructor,!we(t)||t instanceof t)?(g(e,function(e,t){n=t}),"undefined"==typeof n||yt.call(e,n)):!1}function ge(e){return Ft[e]}function ve(e){return e&&"object"==typeof e&&"number"==typeof e.length&&ct.call(e)==A||!1}function ye(e,t,n){var i=Dt(e),o=i.length;for(t=te(t,n,3);o--&&(n=i[o],!1!==t(e[n],n,e)););return e}function me(e){var t=[];return g(e,function(e,n){we(e)&&t.push(n)}),t.sort()}function be(e){for(var t=-1,n=Dt(e),i=n.length,o={};++t<i;){var r=n[t];o[e[r]]=r}return o}function we(e){return"function"==typeof e}function _e(e){return!(!e||!J[typeof e])}function ke(e){return"number"==typeof e||e&&"object"==typeof e&&ct.call(e)==F||!1}function Ce(e){return"string"==typeof e||e&&"object"==typeof e&&ct.call(e)==H||!1}function xe(e){for(var t=-1,n=Dt(e),i=n.length,o=Ve(i);++t<i;)o[t]=e[n[t]];return o}function Re(e,t,n){var i=-1,o=he(),r=e?e.length:0,s=!1;return n=(0>n?Mt(0,r+n):n)||0,zt(e)?s=-1<o(e,t,n):"number"==typeof r?s=-1<(Ce(e)?e.indexOf(t,n):o(e,t,n)):p(e,function(e){return++i<n?void 0:!(s=e===t)}),s}function je(e,t,n){var i=!0;t=W.createCallback(t,n,3),n=-1;var o=e?e.length:0;if("number"==typeof o)for(;++n<o&&(i=!!t(e[n],n,e)););else p(e,function(e,n,o){return i=!!t(e,n,o)});return i}function Se(e,t,n){var i=[];t=W.createCallback(t,n,3),n=-1;var o=e?e.length:0;if("number"==typeof o)for(;++n<o;){var r=e[n];t(r,n,e)&&i.push(r)}else p(e,function(e,n,o){t(e,n,o)&&i.push(e)});return i}function Me(e,t,n){t=W.createCallback(t,n,3),n=-1;var i=e?e.length:0;if("number"!=typeof i){var o;return p(e,function(e,n,i){return t(e,n,i)?(o=e,!1):void 0}),o}for(;++n<i;){var r=e[n];if(t(r,n,e))return r}}function Ie(e,t,n){var i=-1,o=e?e.length:0;if(t=t&&"undefined"==typeof n?t:te(t,n,3),"number"==typeof o)for(;++i<o&&!1!==t(e[i],i,e););else p(e,t);return e}function Oe(e,t,n){var i=e?e.length:0;if(t=t&&"undefined"==typeof n?t:te(t,n,3),"number"==typeof i)for(;i--&&!1!==t(e[i],i,e););else{var o=Dt(e),i=o.length;p(e,function(e,n,r){return n=o?o[--i]:--i,t(r[n],n,r)})}return e}function Te(e,t,n){var i=-1,o=e?e.length:0;if(t=W.createCallback(t,n,3),"number"==typeof o)for(var r=Ve(o);++i<o;)r[i]=t(e[i],i,e);else r=[],p(e,function(e,n,o){r[++i]=t(e,n,o)});return r}function Ee(e,t,n){var o=-1/0,r=o;if("function"!=typeof t&&n&&n[t]===e&&(t=null),null==t&&zt(e)){n=-1;for(var s=e.length;++n<s;){var a=e[n];a>r&&(r=a)}}else t=null==t&&Ce(e)?i:W.createCallback(t,n,3),Ie(e,function(e,n,i){n=t(e,n,i),n>o&&(o=n,r=e)});return r}function Ae(e,t,n,i){if(!e)return n;var o=3>arguments.length;t=W.createCallback(t,i,4);var r=-1,s=e.length;if("number"==typeof s)for(o&&(n=e[++r]);++r<s;)n=t(n,e[r],r,e);else p(e,function(e,i,r){n=o?(o=!1,e):t(n,e,i,r)});return n}function Pe(e,t,n,i){var o=3>arguments.length;return t=W.createCallback(t,i,4),Oe(e,function(e,i,r){n=o?(o=!1,e):t(n,e,i,r)}),n}function ze(e){var t=-1,n=e?e.length:0,i=Ve("number"==typeof n?n:0);return Ie(e,function(e){var n=ae(0,++t);i[t]=i[n],i[n]=e}),i}function De(e,t,n){var i;t=W.createCallback(t,n,3),n=-1;var o=e?e.length:0;if("number"==typeof o)for(;++n<o&&!(i=t(e[n],n,e)););else p(e,function(e,n,o){return!(i=t(e,n,o))});return!!i}function Ne(e,t,n){var i=0,o=e?e.length:0;if("number"!=typeof t&&null!=t){var r=-1;for(t=W.createCallback(t,n,3);++r<o&&t(e[r],r,e);)i++}else if(i=t,null==i||n)return e?e[0]:d;return f(e,0,It(Mt(0,i),o))}function Fe(t,n,i){if("number"==typeof i){var o=t?t.length:0;i=0>i?Mt(0,o+i):i||0}else if(i)return i=Be(t,n),t[i]===n?i:-1;return e(t,n,i)}function Ge(e,t,n){if("number"!=typeof t&&null!=t){var i=0,o=-1,r=e?e.length:0;for(t=W.createCallback(t,n,3);++o<r&&t(e[o],o,e);)i++}else i=null==t||n?1:Mt(0,t);return f(e,i)}function Be(e,t,n,i){var o=0,r=e?e.length:o;for(n=n?W.createCallback(n,i,1):Qe,t=n(t);r>o;)i=o+r>>>1,n(e[i])<t?o=i+1:r=i;return o}function He(e,t,n,i){return"boolean"!=typeof t&&null!=t&&(i=n,n="function"!=typeof t&&i&&i[t]===e?null:t,t=!1),null!=n&&(n=W.createCallback(n,i,3)),le(e,t,n)}function qe(){for(var e=1<arguments.length?arguments:arguments[0],t=-1,n=e?Ee(Jt(e,"length")):0,i=Ve(0>n?0:n);++t<n;)i[t]=Jt(e,t);return i}function $e(e,t){var n=-1,i=e?e.length:0,o={};for(t||!i||zt(e[0])||(t=[]);++n<i;){var r=e[n];t?o[r]=t[n]:r&&(o[r[0]]=r[1])}return o}function Le(e,t){return 2<arguments.length?ce(e,17,f(arguments,2),null,t):ce(e,1,null,null,t)}function Je(e,t,n){function i(){c&&dt(c),s=c=f=d,(g||p!==t)&&(h=Qt(),a=e.apply(u,r),c||s||(r=u=null))}function o(){var n=t-(Qt()-l);n>0?c=bt(o,n):(s&&dt(s),n=f,s=c=f=d,n&&(h=Qt(),a=e.apply(u,r),c||s||(r=u=null)))}var r,s,a,l,u,c,f,h=0,p=!1,g=!0;if(!we(e))throw new st;if(t=Mt(0,t)||0,!0===n)var v=!0,g=!1;else _e(n)&&(v=n.leading,p="maxWait"in n&&(Mt(t,n.maxWait)||0),g="trailing"in n?n.trailing:g);return function(){if(r=arguments,l=Qt(),u=this,f=g&&(c||!v),!1===p)var n=v&&!c;else{s||v||(h=l);var d=p-(l-h),y=0>=d;y?(s&&(s=dt(s)),h=l,a=e.apply(u,r)):s||(s=bt(i,d))}return y&&c?c=dt(c):c||t===p||(c=bt(o,t)),n&&(y=!0,a=e.apply(u,r)),!y||c||s||(r=u=null),a}}function Qe(e){return e}function Ue(e,t,n){var i=!0,o=t&&me(t);t&&(n||o.length)||(null==n&&(n=t),r=X,t=e,e=W,o=me(t)),!1===n?i=!1:_e(n)&&"chain"in n&&(i=n.chain);var r=e,s=we(r);Ie(o,function(n){var o=e[n]=t[n];s&&(r.prototype[n]=function(){var t=this.__chain__,n=this.__wrapped__,s=[n];if(mt.apply(s,arguments),s=o.apply(e,s),i||t){if(n===s&&_e(s))return this;s=new r(s),s.__chain__=t}return s})})}function Ke(){}function We(e){return function(t){return t[e]}}function Xe(){return this.__wrapped__}n=n?Y.defaults(U.Object(),n,Y.pick(U,E)):U;var Ve=n.Array,Ye=n.Boolean,Ze=n.Date,et=n.Function,tt=n.Math,nt=n.Number,it=n.Object,ot=n.RegExp,rt=n.String,st=n.TypeError,at=[],lt=it.prototype,ut=n._,ct=lt.toString,ft=ot("^"+rt(ct).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),ht=tt.ceil,dt=n.clearTimeout,pt=tt.floor,gt=et.prototype.toString,vt=de(vt=it.getPrototypeOf)&&vt,yt=lt.hasOwnProperty,mt=at.push,bt=n.setTimeout,wt=at.splice,_t=at.unshift,kt=function(){try{var e={},t=de(t=it.defineProperty)&&t,n=t(e,e,e)&&t}catch(i){}return n}(),Ct=de(Ct=it.create)&&Ct,xt=de(xt=Ve.isArray)&&xt,Rt=n.isFinite,jt=n.isNaN,St=de(St=it.keys)&&St,Mt=tt.max,It=tt.min,Ot=n.parseInt,Tt=tt.random,Et={};Et[P]=Ve,Et[z]=Ye,Et[D]=Ze,Et[N]=et,Et[G]=it,Et[F]=nt,Et[B]=ot,Et[H]=rt,X.prototype=W.prototype;var At=W.support={};At.funcDecomp=!de(n.a)&&O.test(h),At.funcNames="string"==typeof et.name,W.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:S,variable:"",imports:{_:W}},Ct||(ee=function(){function e(){}return function(t){if(_e(t)){e.prototype=t;var i=new e;e.prototype=null}return i||n.Object()}}());var Pt=kt?function(e,t){L.value=t,kt(e,"__bindData__",L)}:Ke,zt=xt||function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&ct.call(e)==P||!1},Dt=St?function(e){return _e(e)?St(e):[]}:K,Nt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ft=be(Nt),Gt=ot("("+Dt(Ft).join("|")+")","g"),Bt=ot("["+Dt(Nt).join("")+"]","g"),Ht=vt?function(e){if(!e||ct.call(e)!=G)return!1;var t=e.valueOf,n=de(t)&&(n=vt(t))&&vt(n);return n?e==n||vt(e)==n:pe(e)}:pe,qt=ue(function(e,t,n){yt.call(e,n)?e[n]++:e[n]=1}),$t=ue(function(e,t,n){(yt.call(e,n)?e[n]:e[n]=[]).push(t)}),Lt=ue(function(e,t,n){e[n]=t}),Jt=Te,Qt=de(Qt=Ze.now)&&Qt||function(){return(new Ze).getTime()},Ut=8==Ot(w+"08")?Ot:function(e,t){return Ot(Ce(e)?e.replace(M,""):e,t||0)};return W.after=function(e,t){if(!we(t))throw new st;return function(){return 1>--e?t.apply(this,arguments):void 0}},W.assign=Q,W.at=function(e){for(var t=arguments,n=-1,i=oe(t,!0,!1,1),t=t[2]&&t[2][t[1]]===e?1:i.length,o=Ve(t);++n<t;)o[n]=e[i[n]];return o},W.bind=Le,W.bindAll=function(e){for(var t=1<arguments.length?oe(arguments,!0,!1,1):me(e),n=-1,i=t.length;++n<i;){var o=t[n];e[o]=ce(e[o],1,null,null,e)}return e},W.bindKey=function(e,t){return 2<arguments.length?ce(t,19,f(arguments,2),null,e):ce(t,3,null,null,e)},W.chain=function(e){return e=new X(e),e.__chain__=!0,e},W.compact=function(e){for(var t=-1,n=e?e.length:0,i=[];++t<n;){var o=e[t];o&&i.push(o)}return i},W.compose=function(){for(var e=arguments,t=e.length;t--;)if(!we(e[t]))throw new st;return function(){for(var t=arguments,n=e.length;n--;)t=[e[n].apply(this,t)];return t[0]}},W.constant=function(e){return function(){return e}},W.countBy=qt,W.create=function(e,t){var n=ee(e);return t?Q(n,t):n},W.createCallback=function(e,t,n){var i=typeof e;if(null==e||"function"==i)return te(e,t,n);if("object"!=i)return We(e);var o=Dt(e),r=o[0],s=e[r];return 1!=o.length||s!==s||_e(s)?function(t){for(var n=o.length,i=!1;n--&&(i=re(t[o[n]],e[o[n]],null,!0)););return i}:function(e){return e=e[r],s===e&&(0!==s||1/s==1/e)}},W.curry=function(e,t){return t="number"==typeof t?t:+t||e.length,ce(e,4,null,null,null,t)},W.debounce=Je,W.defaults=b,W.defer=function(e){if(!we(e))throw new st;var t=f(arguments,1);return bt(function(){e.apply(d,t)},1)},W.delay=function(e,t){if(!we(e))throw new st;var n=f(arguments,2);return bt(function(){e.apply(d,n)},t)},W.difference=function(e){return ie(e,oe(arguments,!0,!0,1))},W.filter=Se,W.flatten=function(e,t,n,i){return"boolean"!=typeof t&&null!=t&&(i=n,n="function"!=typeof t&&i&&i[t]===e?null:t,t=!1),null!=n&&(e=Te(e,n,i)),oe(e,t)},W.forEach=Ie,W.forEachRight=Oe,W.forIn=g,W.forInRight=function(e,t,n){var i=[];g(e,function(e,t){i.push(t,e)});var o=i.length;for(t=te(t,n,3);o--&&!1!==t(i[o--],i[o],e););return e},W.forOwn=p,W.forOwnRight=ye,W.functions=me,W.groupBy=$t,W.indexBy=Lt,W.initial=function(e,t,n){var i=0,o=e?e.length:0;if("number"!=typeof t&&null!=t){var r=o;for(t=W.createCallback(t,n,3);r--&&t(e[r],r,e);)i++}else i=null==t||n?1:t||i;return f(e,0,It(Mt(0,o-i),o))},W.intersection=function(){for(var n=[],i=-1,o=arguments.length,s=a(),l=he(),f=l===e,h=a();++i<o;){var d=arguments[i];(zt(d)||ve(d))&&(n.push(d),s.push(f&&d.length>=m&&r(i?n[i]:h)))}var f=n[0],p=-1,g=f?f.length:0,v=[];e:for(;++p<g;){var y=s[0],d=f[p];if(0>(y?t(y,d):l(h,d))){for(i=o,(y||h).push(d);--i;)if(y=s[i],0>(y?t(y,d):l(n[i],d)))continue e;v.push(d)}}for(;o--;)(y=s[o])&&c(y);return u(s),u(h),v},W.invert=be,W.invoke=function(e,t){var n=f(arguments,2),i=-1,o="function"==typeof t,r=e?e.length:0,s=Ve("number"==typeof r?r:0);return Ie(e,function(e){s[++i]=(o?t:e[t]).apply(e,n)}),s},W.keys=Dt,W.map=Te,W.mapValues=function(e,t,n){var i={};return t=W.createCallback(t,n,3),p(e,function(e,n,o){i[n]=t(e,n,o)}),i},W.max=Ee,W.memoize=function(e,t){function n(){var i=n.cache,o=t?t.apply(this,arguments):y+arguments[0];return yt.call(i,o)?i[o]:i[o]=e.apply(this,arguments)}if(!we(e))throw new st;return n.cache={},n},W.merge=function(e){var t=arguments,n=2;if(!_e(e))return e;if("number"!=typeof t[2]&&(n=t.length),n>3&&"function"==typeof t[n-2])var i=te(t[--n-1],t[n--],2);else n>2&&"function"==typeof t[n-1]&&(i=t[--n]);for(var t=f(arguments,1,n),o=-1,r=a(),s=a();++o<n;)se(e,t[o],i,r,s);return u(r),u(s),e},W.min=function(e,t,n){var o=1/0,r=o;if("function"!=typeof t&&n&&n[t]===e&&(t=null),null==t&&zt(e)){n=-1;for(var s=e.length;++n<s;){var a=e[n];r>a&&(r=a)}}else t=null==t&&Ce(e)?i:W.createCallback(t,n,3),Ie(e,function(e,n,i){n=t(e,n,i),o>n&&(o=n,r=e)});return r},W.omit=function(e,t,n){var i={};if("function"!=typeof t){var o=[];g(e,function(e,t){o.push(t)});for(var o=ie(o,oe(arguments,!0,!1,1)),r=-1,s=o.length;++r<s;){var a=o[r];i[a]=e[a]}}else t=W.createCallback(t,n,3),g(e,function(e,n,o){t(e,n,o)||(i[n]=e)});return i},W.once=function(e){var t,n;if(!we(e))throw new st;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},W.pairs=function(e){for(var t=-1,n=Dt(e),i=n.length,o=Ve(i);++t<i;){var r=n[t];o[t]=[r,e[r]]}return o},W.partial=function(e){return ce(e,16,f(arguments,1))},W.partialRight=function(e){return ce(e,32,null,f(arguments,1))},W.pick=function(e,t,n){var i={};if("function"!=typeof t)for(var o=-1,r=oe(arguments,!0,!1,1),s=_e(e)?r.length:0;++o<s;){var a=r[o];a in e&&(i[a]=e[a])}else t=W.createCallback(t,n,3),g(e,function(e,n,o){t(e,n,o)&&(i[n]=e)});return i},W.pluck=Jt,W.property=We,W.pull=function(e){for(var t=arguments,n=0,i=t.length,o=e?e.length:0;++n<i;)for(var r=-1,s=t[n];++r<o;)e[r]===s&&(wt.call(e,r--,1),o--);return e},W.range=function(e,t,n){e=+e||0,n="number"==typeof n?n:+n||1,null==t&&(t=e,e=0);var i=-1;t=Mt(0,ht((t-e)/(n||1)));for(var o=Ve(t);++i<t;)o[i]=e,e+=n;return o},W.reject=function(e,t,n){return t=W.createCallback(t,n,3),Se(e,function(e,n,i){return!t(e,n,i)})},W.remove=function(e,t,n){var i=-1,o=e?e.length:0,r=[];for(t=W.createCallback(t,n,3);++i<o;)n=e[i],t(n,i,e)&&(r.push(n),wt.call(e,i--,1),o--);return r},W.rest=Ge,W.shuffle=ze,W.sortBy=function(e,t,n){var i=-1,r=zt(t),s=e?e.length:0,f=Ve("number"==typeof s?s:0);for(r||(t=W.createCallback(t,n,3)),Ie(e,function(e,n,o){var s=f[++i]=l();r?s.m=Te(t,function(t){return e[t]}):(s.m=a())[0]=t(e,n,o),s.n=i,s.o=e}),s=f.length,f.sort(o);s--;)e=f[s],f[s]=e.o,r||u(e.m),c(e);return f},W.tap=function(e,t){return t(e),e},W.throttle=function(e,t,n){var i=!0,o=!0;if(!we(e))throw new st;return!1===n?i=!1:_e(n)&&(i="leading"in n?n.leading:i,o="trailing"in n?n.trailing:o),$.leading=i,$.maxWait=t,$.trailing=o,Je(e,t,$)},W.times=function(e,t,n){e=-1<(e=+e)?e:0;var i=-1,o=Ve(e);for(t=te(t,n,1);++i<e;)o[i]=t(i);return o},W.toArray=function(e){return e&&"number"==typeof e.length?f(e):xe(e)},W.transform=function(e,t,n,i){var o=zt(e);if(null==n)if(o)n=[];else{var r=e&&e.constructor;n=ee(r&&r.prototype)}return t&&(t=W.createCallback(t,i,4),(o?Ie:p)(e,function(e,i,o){return t(n,e,i,o)})),n},W.union=function(){return le(oe(arguments,!0,!0))},W.uniq=He,W.values=xe,W.where=Se,W.without=function(e){return ie(e,f(arguments,1))},W.wrap=function(e,t){return ce(t,16,[e])},W.xor=function(){for(var e=-1,t=arguments.length;++e<t;){var n=arguments[e];if(zt(n)||ve(n))var i=i?le(ie(i,n).concat(ie(n,i))):n}return i||[]},W.zip=qe,W.zipObject=$e,W.collect=Te,W.drop=Ge,W.each=Ie,W.eachRight=Oe,W.extend=Q,W.methods=me,W.object=$e,W.select=Se,W.tail=Ge,W.unique=He,W.unzip=qe,Ue(W),W.clone=function(e,t,n,i){return"boolean"!=typeof t&&null!=t&&(i=n,n=t,t=!1),Z(e,t,"function"==typeof n&&te(n,i,1))},W.cloneDeep=function(e,t,n){return Z(e,!0,"function"==typeof t&&te(t,n,1))},W.contains=Re,W.escape=function(e){return null==e?"":rt(e).replace(Bt,fe)},W.every=je,W.find=Me,W.findIndex=function(e,t,n){var i=-1,o=e?e.length:0;for(t=W.createCallback(t,n,3);++i<o;)if(t(e[i],i,e))return i;return-1},W.findKey=function(e,t,n){var i;return t=W.createCallback(t,n,3),p(e,function(e,n,o){return t(e,n,o)?(i=n,!1):void 0}),i},W.findLast=function(e,t,n){var i;return t=W.createCallback(t,n,3),Oe(e,function(e,n,o){return t(e,n,o)?(i=e,!1):void 0}),i},W.findLastIndex=function(e,t,n){var i=e?e.length:0;for(t=W.createCallback(t,n,3);i--;)if(t(e[i],i,e))return i;return-1},W.findLastKey=function(e,t,n){var i;return t=W.createCallback(t,n,3),ye(e,function(e,n,o){return t(e,n,o)?(i=n,!1):void 0}),i},W.has=function(e,t){return e?yt.call(e,t):!1},W.identity=Qe,W.indexOf=Fe,W.isArguments=ve,W.isArray=zt,W.isBoolean=function(e){return!0===e||!1===e||e&&"object"==typeof e&&ct.call(e)==z||!1},W.isDate=function(e){return e&&"object"==typeof e&&ct.call(e)==D||!1},W.isElement=function(e){return e&&1===e.nodeType||!1},W.isEmpty=function(e){var t=!0;if(!e)return t;var n=ct.call(e),i=e.length;return n==P||n==H||n==A||n==G&&"number"==typeof i&&we(e.splice)?!i:(p(e,function(){return t=!1}),t)},W.isEqual=function(e,t,n,i){return re(e,t,"function"==typeof n&&te(n,i,2))},W.isFinite=function(e){return Rt(e)&&!jt(parseFloat(e))},W.isFunction=we,W.isNaN=function(e){return ke(e)&&e!=+e},W.isNull=function(e){return null===e},W.isNumber=ke,W.isObject=_e,W.isPlainObject=Ht,W.isRegExp=function(e){return e&&"object"==typeof e&&ct.call(e)==B||!1},W.isString=Ce,W.isUndefined=function(e){return"undefined"==typeof e},W.lastIndexOf=function(e,t,n){var i=e?e.length:0;for("number"==typeof n&&(i=(0>n?Mt(0,i+n):It(n,i-1))+1);i--;)if(e[i]===t)return i;return-1},W.mixin=Ue,W.noConflict=function(){return n._=ut,this},W.noop=Ke,W.now=Qt,W.parseInt=Ut,W.random=function(e,t,n){var i=null==e,o=null==t;return null==n&&("boolean"==typeof e&&o?(n=e,e=1):o||"boolean"!=typeof t||(n=t,o=!0)),i&&o&&(t=1),e=+e||0,o?(t=e,e=0):t=+t||0,n||e%1||t%1?(n=Tt(),It(e+n*(t-e+parseFloat("1e-"+((n+"").length-1))),t)):ae(e,t)},W.reduce=Ae,W.reduceRight=Pe,W.result=function(e,t){if(e){var n=e[t];return we(n)?e[t]():n}},W.runInContext=h,W.size=function(e){var t=e?e.length:0;return"number"==typeof t?t:Dt(e).length},W.some=De,W.sortedIndex=Be,W.template=function(e,t,n){var i=W.templateSettings;e=rt(e||""),n=b({},n,i);var o,r=b({},n.imports,i.imports),i=Dt(r),r=xe(r),a=0,l=n.interpolate||I,u="__p+='",l=ot((n.escape||I).source+"|"+l.source+"|"+(l===S?x:I).source+"|"+(n.evaluate||I).source+"|$","g");e.replace(l,function(t,n,i,r,l,c){return i||(i=r),u+=e.slice(a,c).replace(T,s),n&&(u+="'+__e("+n+")+'"),l&&(o=!0,u+="';"+l+";\n__p+='"),i&&(u+="'+((__t=("+i+"))==null?'':__t)+'"),a=c+t.length,t}),u+="';",l=n=n.variable,l||(n="obj",u="with("+n+"){"+u+"}"),u=(o?u.replace(_,""):u).replace(k,"$1").replace(C,"$1;"),u="function("+n+"){"+(l?"":n+"||("+n+"={});")+"var __t,__p='',__e=_.escape"+(o?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+u+"return __p}";try{var c=et(i,"return "+u).apply(d,r)}catch(f){throw f.source=u,f}return t?c(t):(c.source=u,c)},W.unescape=function(e){return null==e?"":rt(e).replace(Gt,ge)},W.uniqueId=function(e){var t=++v;return rt(null==e?"":e)+t},W.all=je,W.any=De,W.detect=Me,W.findWhere=Me,W.foldl=Ae,W.foldr=Pe,W.include=Re,W.inject=Ae,Ue(function(){var e={};return p(W,function(t,n){W.prototype[n]||(e[n]=t)}),e}(),!1),W.first=Ne,W.last=function(e,t,n){var i=0,o=e?e.length:0;if("number"!=typeof t&&null!=t){var r=o;for(t=W.createCallback(t,n,3);r--&&t(e[r],r,e);)i++}else if(i=t,null==i||n)return e?e[o-1]:d;return f(e,Mt(0,o-i))},W.sample=function(e,t,n){return e&&"number"!=typeof e.length&&(e=xe(e)),null==t||n?e?e[ae(0,e.length-1)]:d:(e=ze(e),e.length=It(Mt(0,t),e.length),e)},W.take=Ne,W.head=Ne,p(W,function(e,t){var n="sample"!==t;W.prototype[t]||(W.prototype[t]=function(t,i){var o=this.__chain__,r=e(this.__wrapped__,t,i);return o||null!=t&&(!i||n&&"function"==typeof t)?new X(r,o):r})}),W.VERSION="2.4.1",W.prototype.chain=function(){return this.__chain__=!0,this},W.prototype.toString=function(){return rt(this.__wrapped__)},W.prototype.value=Xe,W.prototype.valueOf=Xe,Ie(["join","pop","shift"],function(e){var t=at[e];W.prototype[e]=function(){var e=this.__chain__,n=t.apply(this.__wrapped__,arguments);return e?new X(n,e):n}}),Ie(["push","reverse","sort","unshift"],function(e){var t=at[e];W.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),Ie(["concat","slice","splice"],function(e){var t=at[e];W.prototype[e]=function(){return new X(t.apply(this.__wrapped__,arguments),this.__chain__)}}),W}var d,p=[],g=[],v=0,y=+new Date+"",m=75,b=40,w=" 	\f \ufeff\n\r\u2028\u2029 ᠎             　",_=/\b__p\+='';/g,k=/\b(__p\+=)''\+/g,C=/(__e\(.*?\)|\b__t\))\+'';/g,x=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,R=/\w*$/,j=/^\s*function[ \n\r\t]+\w/,S=/<%=([\s\S]+?)%>/g,M=RegExp("^["+w+"]*0+(?=.$)"),I=/($^)/,O=/\bthis\b/,T=/['\n\r\t\u2028\u2029\\]/g,E="Array Boolean Date Function Math Number Object RegExp String _ attachEvent clearTimeout isFinite isNaN parseInt setTimeout".split(" "),A="[object Arguments]",P="[object Array]",z="[object Boolean]",D="[object Date]",N="[object Function]",F="[object Number]",G="[object Object]",B="[object RegExp]",H="[object String]",q={};q[N]=!1,q[A]=q[P]=q[z]=q[D]=q[F]=q[G]=q[B]=q[H]=!0;var $={leading:!1,maxWait:0,trailing:!1},L={configurable:!1,enumerable:!1,value:null,writable:!1},J={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},Q={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},U=J[typeof window]&&window||this,K=J[typeof exports]&&exports&&!exports.nodeType&&exports,W=J[typeof module]&&module&&!module.nodeType&&module,X=W&&W.exports===K&&K,V=J[typeof global]&&global;!V||V.global!==V&&V.window!==V||(U=V);var Y=h();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(U._=Y,define(function(){return Y})):K&&W?X?(W.exports=Y)._=Y:K._=Y:U._=Y}).call(this),function(e,t){if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(n,i,o){e.Backbone=t(e,o,n,i)});else if("undefined"!=typeof exports){var n=require("underscore");t(e,exports,n)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,i){var o=e.Backbone,r=[],s=(r.push,r.slice);r.splice;t.VERSION="1.1.2",t.$=i,t.noConflict=function(){return e.Backbone=o,this},t.emulateHTTP=!1,t.emulateJSON=!1;var a=t.Events={on:function(e,t,n){if(!u(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var i=this._events[e]||(this._events[e]=[]);return i.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,i){if(!u(this,"once",e,[t,i])||!t)return this;var o=this,r=n.once(function(){o.off(e,r),t.apply(this,arguments)});return r._callback=t,this.on(e,r,i)},off:function(e,t,i){var o,r,s,a,l,c,f,h;if(!this._events||!u(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events=void 0,this;for(a=e?[e]:n.keys(this._events),l=0,c=a.length;c>l;l++)if(e=a[l],s=this._events[e]){if(this._events[e]=o=[],t||i)for(f=0,h=s.length;h>f;f++)r=s[f],(t&&t!==r.callback&&t!==r.callback._callback||i&&i!==r.context)&&o.push(r);o.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=s.call(arguments,1);if(!u(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&c(n,t),i&&c(i,arguments),this},stopListening:function(e,t,i){var o=this._listeningTo;if(!o)return this;var r=!t&&!i;i||"object"!=typeof t||(i=this),e&&((o={})[e._listenId]=e);for(var s in o)e=o[s],e.off(t,i,this),(r||n.isEmpty(e._events))&&delete this._listeningTo[s];return this}},l=/\s+/,u=function(e,t,n,i){if(!n)return!0;if("object"==typeof n){for(var o in n)e[t].apply(e,[o,n[o]].concat(i));return!1}if(l.test(n)){for(var r=n.split(l),s=0,a=r.length;a>s;s++)e[t].apply(e,[r[s]].concat(i));return!1}return!0},c=function(e,t){var n,i=-1,o=e.length,r=t[0],s=t[1],a=t[2];switch(t.length){case 0:for(;++i<o;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<o;)(n=e[i]).callback.call(n.ctx,r);return;case 2:for(;++i<o;)(n=e[i]).callback.call(n.ctx,r,s);return;case 3:for(;++i<o;)(n=e[i]).callback.call(n.ctx,r,s,a);return;default:for(;++i<o;)(n=e[i]).callback.apply(n.ctx,t);return}},f={listenTo:"on",listenToOnce:"once"};n.each(f,function(e,t){a[t]=function(t,i,o){var r=this._listeningTo||(this._listeningTo={}),s=t._listenId||(t._listenId=n.uniqueId("l"));return r[s]=t,o||"object"!=typeof i||(o=this),t[e](i,o,this),this}}),a.bind=a.on,a.unbind=a.off,n.extend(t,a);var h=t.Model=function(e,t){var i=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(h.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var o,r,s,a,l,u,c,f;if(null==e)return this;if("object"==typeof e?(r=e,i=t):(r={})[e]=t,i||(i={}),!this._validate(r,i))return!1;s=i.unset,l=i.silent,a=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=n.clone(this.attributes),this.changed={}),f=this.attributes,c=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(o in r)t=r[o],n.isEqual(f[o],t)||a.push(o),n.isEqual(c[o],t)?delete this.changed[o]:this.changed[o]=t,s?delete f[o]:f[o]=t;if(!l){a.length&&(this._pending=i);for(var h=0,d=a.length;d>h;h++)this.trigger("change:"+a[h],this,f[a[h]],i)}if(u)return this;if(!l)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,i=!1,o=this._changing?this._previousAttributes:this.attributes;for(var r in e)n.isEqual(o[r],t=e[r])||((i||(i={}))[r]=t);
return i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,i=e.success;return e.success=function(n){return t.set(t.parse(n,e),e)?(i&&i(t,n,e),void t.trigger("sync",t,n,e)):!1},N(this,e),this.sync("read",this,e)},save:function(e,t,i){var o,r,s,a=this.attributes;if(null==e||"object"==typeof e?(o=e,i=t):(o={})[e]=t,i=n.extend({validate:!0},i),o&&!i.wait){if(!this.set(o,i))return!1}else if(!this._validate(o,i))return!1;o&&i.wait&&(this.attributes=n.extend({},a,o)),void 0===i.parse&&(i.parse=!0);var l=this,u=i.success;return i.success=function(e){l.attributes=a;var t=l.parse(e,i);return i.wait&&(t=n.extend(o||{},t)),n.isObject(t)&&!l.set(t,i)?!1:(u&&u(l,e,i),void l.trigger("sync",l,e,i))},N(this,i),r=this.isNew()?"create":i.patch?"patch":"update","patch"===r&&(i.attrs=o),s=this.sync(r,this,i),o&&i.wait&&(this.attributes=a),s},destroy:function(e){e=e?n.clone(e):{};var t=this,i=e.success,o=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(n){(e.wait||t.isNew())&&o(),i&&i(t,n,e),t.isNew()||t.trigger("sync",t,n,e)},this.isNew())return e.success(),!1;N(this,e);var r=this.sync("delete",this,e);return e.wait||o(),r},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||D();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,n.extend(t,{validationError:i})),!1):!0}});var d=["keys","values","pairs","invert","pick","omit"];n.each(d,function(e){h.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var p=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},v={add:!0,remove:!1};n.extend(p.prototype,a,{model:h,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,v))},remove:function(e,t){var i=!n.isArray(e);e=i?[e]:n.clone(e),t||(t={});var o,r,s,a;for(o=0,r=e.length;r>o;o++)a=e[o]=this.get(e[o]),a&&(delete this._byId[a.id],delete this._byId[a.cid],s=this.indexOf(a),this.models.splice(s,1),this.length--,t.silent||(t.index=s,a.trigger("remove",a,this,t)),this._removeReference(a,t));return i?e[0]:e},set:function(e,t){t=n.defaults({},t,g),t.parse&&(e=this.parse(e,t));var i=!n.isArray(e);e=i?e?[e]:[]:n.clone(e);var o,r,s,a,l,u,c,f=t.at,d=this.model,p=this.comparator&&null==f&&t.sort!==!1,v=n.isString(this.comparator)?this.comparator:null,y=[],m=[],b={},w=t.add,_=t.merge,k=t.remove,C=!p&&w&&k?[]:!1;for(o=0,r=e.length;r>o;o++){if(l=e[o]||{},s=l instanceof h?a=l:l[d.prototype.idAttribute||"id"],u=this.get(s))k&&(b[u.cid]=!0),_&&(l=l===a?a.attributes:l,t.parse&&(l=u.parse(l,t)),u.set(l,t),p&&!c&&u.hasChanged(v)&&(c=!0)),e[o]=u;else if(w){if(a=e[o]=this._prepareModel(l,t),!a)continue;y.push(a),this._addReference(a,t)}a=u||a,!C||!a.isNew()&&b[a.id]||C.push(a),b[a.id]=!0}if(k){for(o=0,r=this.length;r>o;++o)b[(a=this.models[o]).cid]||m.push(a);m.length&&this.remove(m,t)}if(y.length||C&&C.length)if(p&&(c=!0),this.length+=y.length,null!=f)for(o=0,r=y.length;r>o;o++)this.models.splice(f+o,0,y[o]);else{C&&(this.models.length=0);var x=C||y;for(o=0,r=x.length;r>o;o++)this.models.push(x[o])}if(c&&this.sort({silent:!0}),!t.silent){for(o=0,r=y.length;r>o;o++)(a=y[o]).trigger("add",a,this,t);(c||C&&C.length)&&this.trigger("sort",this,t)}return i?e[0]:e},reset:function(e,t){t||(t={});for(var i=0,o=this.models.length;o>i;i++)this._removeReference(this.models[i],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return s.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,i=this;return e.success=function(n){var o=e.reset?"reset":"set";i[o](n,e),t&&t(i,n,e),i.trigger("sync",i,n,e)},N(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?n.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var i=this,o=t.success;return t.success=function(e,n){t.wait&&i.add(e,t),o&&o(e,n,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof h)return e;t=t?n.clone(t):{},t.collection=this;var i=new this.model(e,t);return i.validationError?(this.trigger("invalid",this,i.validationError,t),!1):i},_addReference:function(e,t){this._byId[e.cid]=e,null!=e.id&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,i),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(y,function(e){p.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var m=["groupBy","countBy","sortBy","indexBy"];n.each(m,function(e){p.prototype[e]=function(t,i){var o=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,o,i)}});var b=t.View=function(e){this.cid=n.uniqueId("view"),e||(e={}),n.extend(this,n.pick(e,_)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,_=["model","collection","el","id","attributes","className","tagName","events"];n.extend(b.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var i=e[t];if(n.isFunction(i)||(i=this[e[t]]),i){var o=t.match(w),r=o[1],s=o[2];i=n.bind(i,this),r+=".delegateEvents"+this.cid,""===s?this.$el.on(r,i):this.$el.on(r,s,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className"));var i=t.$("<"+n.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,o){var r=C[e];n.defaults(o||(o={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var s={type:r,dataType:"json"};if(o.url||(s.url=n.result(i,"url")||D()),null!=o.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(s.contentType="application/json",s.data=JSON.stringify(o.attrs||i.toJSON(o))),o.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),o.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){s.type="POST",o.emulateJSON&&(s.data._method=r);var a=o.beforeSend;o.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",r),a?a.apply(this,arguments):void 0}}"GET"===s.type||o.emulateJSON||(s.processData=!1),"PATCH"===s.type&&k&&(s.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=o.xhr=t.ajax(n.extend(s,o));return i.trigger("request",i,l,o),l};var k=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),C={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var x=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},R=/\((.*?)\)/g,j=/(\(\?)?:\w+/g,S=/\*\w+/g,M=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(x.prototype,a,{initialize:function(){},route:function(e,i,o){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(i)&&(o=i,i=""),o||(o=this[i]);var r=this;return t.history.route(e,function(n){var s=r._extractParameters(e,n);r.execute(o,s),r.trigger.apply(r,["route:"+i].concat(s)),r.trigger("route",i,s),t.history.trigger("route",r,i,s)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(M,"\\$&").replace(R,"(?:$1)?").replace(j,function(e,t){return t?e:"([^/?]+)"}).replace(S,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return n.map(i,function(e,t){return t===i.length-1?e||null:e?decodeURIComponent(e):null})}});var I=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},O=/^[#\/]|\s+$/g,T=/^\/+|\/+$/g,E=/msie [\w.]+/,A=/\/$/,P=/#.*$/;I.started=!1,n.extend(I.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(A,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace(O,"")},start:function(e){if(I.started)throw new Error("Backbone.history has already been started");I.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),o=document.documentMode,r=E.exec(navigator.userAgent.toLowerCase())&&(!o||7>=o);if(this.root=("/"+this.root+"/").replace(T,"/"),r&&this._wantsHashChange){var s=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=s.hide().appendTo("body")[0].contentWindow,this.navigate(i)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace(O,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),I.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(e){return e=this.fragment=this.getFragment(e),n.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(e,t){if(!I.started)return!1;t&&t!==!0||(t={trigger:!!t});var n=this.root+(e=this.getFragment(e||""));if(e=e.replace(P,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),t.history=new I;var z=function(e,t){var i,o=this;i=e&&n.has(e,"constructor")?e.constructor:function(){return o.apply(this,arguments)},n.extend(i,o,t);var r=function(){this.constructor=i};return r.prototype=o.prototype,i.prototype=new r,e&&n.extend(i.prototype,e),i.__super__=o.prototype,i};h.extend=p.extend=x.extend=b.extend=I.extend=z;var D=function(){throw new Error('A "url" property or function must be specified')},N=function(e,t){var n=t.error;t.error=function(i){n&&n(e,i,t),e.trigger("error",e,i,t)}};return t}),function(e,t){"function"==typeof define&&define.amd?define(["exports","backbone","underscore"],t):"undefined"!=typeof exports?t(exports,require("backbone"),require("underscore")):t(e,e.Backbone,e._)}(this,function(e,t,n){"use strict";t.Relational={showWarnings:!0},t.Semaphore={_permitsAvailable:null,_permitsUsed:0,acquire:function(){if(this._permitsAvailable&&this._permitsUsed>=this._permitsAvailable)throw new Error("Max permits acquired");this._permitsUsed++},release:function(){if(0===this._permitsUsed)throw new Error("All permits released");this._permitsUsed--},isLocked:function(){return this._permitsUsed>0},setAvailablePermits:function(e){if(this._permitsUsed>e)throw new Error("Available permits cannot be less than used permits");this._permitsAvailable=e}},t.BlockingQueue=function(){this._queue=[]},n.extend(t.BlockingQueue.prototype,t.Semaphore,{_queue:null,add:function(e){this.isBlocked()?this._queue.push(e):e()},process:function(){var e=this._queue;for(this._queue=[];e&&e.length;)e.shift()()},block:function(){this.acquire()},unblock:function(){this.release(),this.isBlocked()||this.process()},isBlocked:function(){return this.isLocked()}}),t.Relational.eventQueue=new t.BlockingQueue,t.Store=function(){this._collections=[],this._reverseRelations=[],this._orphanRelations=[],this._subModels=[],this._modelScopes=[e]},n.extend(t.Store.prototype,t.Events,{initializeRelation:function(e,i,o){var r=n.isString(i.type)?t[i.type]||this.getObjectByName(i.type):i.type;if(r&&r.prototype instanceof t.Relation){new r(e,i,o)}else t.Relational.showWarnings&&"undefined"!=typeof console&&console.warn("Relation=%o; missing or invalid relation type!",i)},addModelScope:function(e){this._modelScopes.push(e)},removeModelScope:function(e){this._modelScopes=n.without(this._modelScopes,e)},addSubModels:function(e,t){this._subModels.push({superModelType:t,subModels:e})},setupSuperModel:function(e){n.find(this._subModels,function(t){return n.filter(t.subModels||[],function(n,i){var o=this.getObjectByName(n);return e===o?(t.superModelType._subModels[i]=e,e._superModel=t.superModelType,e._subModelTypeValue=i,e._subModelTypeAttribute=t.superModelType.prototype.subModelTypeAttribute,!0):void 0},this).length},this)},addReverseRelation:function(e){var t=n.any(this._reverseRelations,function(t){return n.all(e||[],function(e,n){return e===t[n]})});!t&&e.model&&e.type&&(this._reverseRelations.push(e),this._addRelation(e.model,e),this.retroFitRelation(e))},addOrphanRelation:function(e){var t=n.any(this._orphanRelations,function(t){return n.all(e||[],function(e,n){return e===t[n]})});!t&&e.model&&e.type&&this._orphanRelations.push(e)},processOrphanRelations:function(){n.each(this._orphanRelations.slice(0),function(e){var i=t.Relational.store.getObjectByName(e.relatedModel);i&&(this.initializeRelation(null,e),this._orphanRelations=n.without(this._orphanRelations,e))},this)},_addRelation:function(e,t){e.prototype.relations||(e.prototype.relations=[]),e.prototype.relations.push(t),n.each(e._subModels||[],function(e){this._addRelation(e,t)},this)},retroFitRelation:function(e){var t=this.getCollection(e.model,!1);t&&t.each(function(t){if(t instanceof e.model){new e.type(t,e)}},this)},getCollection:function(e,i){e instanceof t.RelationalModel&&(e=e.constructor);for(var o=e;o._superModel;)o=o._superModel;var r=n.find(this._collections,function(e){return e.model===o});return r||i===!1||(r=this._createCollection(o)),r},getObjectByName:function(e){var t=e.split("."),i=null;return n.find(this._modelScopes,function(e){return i=n.reduce(t||[],function(e,t){return e?e[t]:void 0},e),i&&i!==e?!0:void 0},this),i},_createCollection:function(e){var n;return e instanceof t.RelationalModel&&(e=e.constructor),e.prototype instanceof t.RelationalModel&&(n=new t.Collection,n.model=e,this._collections.push(n)),n},resolveIdForItem:function(e,i){var o=n.isString(i)||n.isNumber(i)?i:null;return null===o&&(i instanceof t.RelationalModel?o=i.id:n.isObject(i)&&(o=i[e.prototype.idAttribute])),o||0===o||(o=null),o},find:function(e,t){var n=this.resolveIdForItem(e,t),i=this.getCollection(e);if(i){var o=i.get(n);if(o instanceof e)return o}return null},register:function(e){var t=this.getCollection(e);if(t){var n=e.collection;t.add(e),e.collection=n}},checkId:function(e,n){var i=this.getCollection(e),o=i&&i.get(n);if(o&&e!==o)throw t.Relational.showWarnings&&"undefined"!=typeof console&&console.warn("Duplicate id! Old RelationalModel=%o, new RelationalModel=%o",o,e),new Error("Cannot instantiate more than one Backbone.RelationalModel with the same id per type!")},update:function(e){var t=this.getCollection(e);t.contains(e)||this.register(e),t._onModelEvent("change:"+e.idAttribute,e,t),e.trigger("relational:change:id",e,t)},unregister:function(e){var i,o;e instanceof t.Model?(i=this.getCollection(e),o=[e]):e instanceof t.Collection?(i=this.getCollection(e.model),o=n.clone(e.models)):(i=this.getCollection(e),o=n.clone(i.models)),n.each(o,function(e){this.stopListening(e),n.invoke(e.getRelations(),"stopListening")},this),n.contains(this._collections,e)?i.reset([]):n.each(o,function(e){i.get(e)?i.remove(e):i.trigger("relational:remove",e,i)},this)},reset:function(){this.stopListening(),n.each(this._collections,function(e){this.unregister(e)},this),this._collections=[],this._subModels=[],this._modelScopes=[e]}}),t.Relational.store=new t.Store,t.Relation=function(e,i,o){if(this.instance=e,i=n.isObject(i)?i:{},this.reverseRelation=n.defaults(i.reverseRelation||{},this.options.reverseRelation),this.options=n.defaults(i,this.options,t.Relation.prototype.options),this.reverseRelation.type=n.isString(this.reverseRelation.type)?t[this.reverseRelation.type]||t.Relational.store.getObjectByName(this.reverseRelation.type):this.reverseRelation.type,this.key=this.options.key,this.keySource=this.options.keySource||this.key,this.keyDestination=this.options.keyDestination||this.keySource||this.key,this.model=this.options.model||this.instance.constructor,this.relatedModel=this.options.relatedModel,n.isUndefined(this.relatedModel)&&(this.relatedModel=this.model),!n.isFunction(this.relatedModel)||this.relatedModel.prototype instanceof t.RelationalModel||(this.relatedModel=n.result(this,"relatedModel")),n.isString(this.relatedModel)&&(this.relatedModel=t.Relational.store.getObjectByName(this.relatedModel)),this.checkPreconditions()&&(!this.options.isAutoRelation&&this.reverseRelation.type&&this.reverseRelation.key&&t.Relational.store.addReverseRelation(n.defaults({isAutoRelation:!0,model:this.relatedModel,relatedModel:this.model,reverseRelation:this.options},this.reverseRelation)),e)){var r=this.keySource;r!==this.key&&n.isObject(this.instance.get(this.key))&&(r=this.key),this.setKeyContents(this.instance.get(r)),this.relatedCollection=t.Relational.store.getCollection(this.relatedModel),this.keySource!==this.key&&delete this.instance.attributes[this.keySource],this.instance._relations[this.key]=this,this.initialize(o),this.options.autoFetch&&this.instance.getAsync(this.key,n.isObject(this.options.autoFetch)?this.options.autoFetch:{}),this.listenTo(this.instance,"destroy",this.destroy).listenTo(this.relatedCollection,"relational:add relational:change:id",this.tryAddRelated).listenTo(this.relatedCollection,"relational:remove",this.removeRelated)}},t.Relation.extend=t.Model.extend,n.extend(t.Relation.prototype,t.Events,t.Semaphore,{options:{createModels:!0,includeInJSON:!0,isAutoRelation:!1,autoFetch:!1,parse:!1},instance:null,key:null,keyContents:null,relatedModel:null,relatedCollection:null,reverseRelation:null,related:null,checkPreconditions:function(){var e=this.instance,i=this.key,o=this.model,r=this.relatedModel,s=t.Relational.showWarnings&&"undefined"!=typeof console;if(!o||!i||!r)return s&&console.warn("Relation=%o: missing model, key or relatedModel (%o, %o, %o).",this,o,i,r),!1;if(!(o.prototype instanceof t.RelationalModel))return s&&console.warn("Relation=%o: model does not inherit from Backbone.RelationalModel (%o).",this,e),!1;if(!(r.prototype instanceof t.RelationalModel))return s&&console.warn("Relation=%o: relatedModel does not inherit from Backbone.RelationalModel (%o).",this,r),!1;if(this instanceof t.HasMany&&this.reverseRelation.type===t.HasMany)return s&&console.warn("Relation=%o: relation is a HasMany, and the reverseRelation is HasMany as well.",this),!1;if(e&&n.keys(e._relations).length){var a=n.find(e._relations,function(e){return e.key===i},this);if(a)return s&&console.warn("Cannot create relation=%o on %o for model=%o: already taken by relation=%o.",this,i,e,a),!1}return!0},setRelated:function(e){this.related=e,this.instance.attributes[this.key]=e},_isReverseRelation:function(e){return e.instance instanceof this.relatedModel&&this.reverseRelation.key===e.key&&this.key===e.reverseRelation.key},getReverseRelations:function(e){for(var t=[],i=n.isUndefined(e)?this.related&&(this.related.models||[this.related]):[e],o=null,r=null,s=0;s<(i||[]).length;s++){o=i[s].getRelations()||[];for(var a=0;a<o.length;a++)r=o[a],this._isReverseRelation(r)&&t.push(r)}return t},destroy:function(){this.stopListening(),this instanceof t.HasOne?this.setRelated(null):this instanceof t.HasMany&&this.setRelated(this._prepareCollection()),n.each(this.getReverseRelations(),function(e){e.removeRelated(this.instance)},this)}}),t.HasOne=t.Relation.extend({options:{reverseRelation:{type:"HasMany"}},initialize:function(e){this.listenTo(this.instance,"relational:change:"+this.key,this.onChange);var t=this.findRelated(e);this.setRelated(t),n.each(this.getReverseRelations(),function(t){t.addRelated(this.instance,e)},this)},findRelated:function(e){var t=null;if(e=n.defaults({parse:this.options.parse},e),this.keyContents instanceof this.relatedModel)t=this.keyContents;else if(this.keyContents||0===this.keyContents){var i=n.defaults({create:this.options.createModels},e);t=this.relatedModel.findOrCreate(this.keyContents,i)}return t&&(this.keyId=null),t},setKeyContents:function(e){this.keyContents=e,this.keyId=t.Relational.store.resolveIdForItem(this.relatedModel,this.keyContents)},onChange:function(e,i,o){if(!this.isLocked()){this.acquire(),o=o?n.clone(o):{};var r=n.isUndefined(o.__related),s=r?this.related:o.__related;if(r){this.setKeyContents(i);var a=this.findRelated(o);this.setRelated(a)}if(s&&this.related!==s&&n.each(this.getReverseRelations(s),function(e){e.removeRelated(this.instance,null,o)},this),n.each(this.getReverseRelations(),function(e){e.addRelated(this.instance,o)},this),!o.silent&&this.related!==s){var l=this;this.changed=!0,t.Relational.eventQueue.add(function(){l.instance.trigger("change:"+l.key,l.instance,l.related,o,!0),l.changed=!1})}this.release()}},tryAddRelated:function(e,t,n){!this.keyId&&0!==this.keyId||e.id!==this.keyId||(this.addRelated(e,n),this.keyId=null)},addRelated:function(e,t){var i=this;e.queue(function(){if(e!==i.related){var o=i.related||null;i.setRelated(e),i.onChange(i.instance,e,n.defaults({__related:o},t))}})},removeRelated:function(e,t,i){if(this.related&&e===this.related){var o=this.related||null;this.setRelated(null),this.onChange(this.instance,e,n.defaults({__related:o},i))}}}),t.HasMany=t.Relation.extend({collectionType:null,options:{reverseRelation:{type:"HasOne"},collectionType:t.Collection,collectionKey:!0,collectionOptions:{}},initialize:function(e){if(this.listenTo(this.instance,"relational:change:"+this.key,this.onChange),this.collectionType=this.options.collectionType,!n.isFunction(this.collectionType)||this.collectionType===t.Collection||this.collectionType.prototype instanceof t.Collection||(this.collectionType=n.result(this,"collectionType")),n.isString(this.collectionType)&&(this.collectionType=t.Relational.store.getObjectByName(this.collectionType)),this.collectionType!==t.Collection&&!(this.collectionType.prototype instanceof t.Collection))throw new Error("`collectionType` must inherit from Backbone.Collection");var i=this.findRelated(e);this.setRelated(i)},_prepareCollection:function(e){if(this.related&&this.stopListening(this.related),!(e&&e instanceof t.Collection)){var i=n.isFunction(this.options.collectionOptions)?this.options.collectionOptions(this.instance):this.options.collectionOptions;e=new this.collectionType(null,i)}if(e.model=this.relatedModel,this.options.collectionKey){var o=this.options.collectionKey===!0?this.options.reverseRelation.key:this.options.collectionKey;e[o]&&e[o]!==this.instance?t.Relational.showWarnings&&"undefined"!=typeof console&&console.warn("Relation=%o; collectionKey=%s already exists on collection=%o",this,o,this.options.collectionKey):o&&(e[o]=this.instance)}return this.listenTo(e,"relational:add",this.handleAddition).listenTo(e,"relational:remove",this.handleRemoval).listenTo(e,"relational:reset",this.handleReset),e},findRelated:function(e){var i=null;if(e=n.defaults({parse:this.options.parse},e),this.keyContents instanceof t.Collection)this._prepareCollection(this.keyContents),i=this.keyContents;else{var o=[];n.each(this.keyContents,function(t){var i=null;i=t instanceof this.relatedModel?t:this.relatedModel.findOrCreate(t,n.extend({merge:!0},e,{create:this.options.createModels})),i&&o.push(i)},this),i=this.related instanceof t.Collection?this.related:this._prepareCollection(),i.set(o,n.defaults({merge:!1,parse:!1},e))}return this.keyIds=n.difference(this.keyIds,n.pluck(i.models,"id")),i},setKeyContents:function(e){this.keyContents=e instanceof t.Collection?e:null,this.keyIds=[],this.keyContents||!e&&0!==e||(this.keyContents=n.isArray(e)?e:[e],n.each(this.keyContents,function(e){var n=t.Relational.store.resolveIdForItem(this.relatedModel,e);(n||0===n)&&this.keyIds.push(n)},this))},onChange:function(e,i,o){o=o?n.clone(o):{},this.setKeyContents(i),this.changed=!1;var r=this.findRelated(o);if(this.setRelated(r),!o.silent){var s=this;t.Relational.eventQueue.add(function(){s.changed&&(s.instance.trigger("change:"+s.key,s.instance,s.related,o,!0),s.changed=!1)})}},handleAddition:function(e,i,o){o=o?n.clone(o):{},this.changed=!0,n.each(this.getReverseRelations(e),function(e){e.addRelated(this.instance,o)},this);var r=this;!o.silent&&t.Relational.eventQueue.add(function(){r.instance.trigger("add:"+r.key,e,r.related,o)})},handleRemoval:function(e,i,o){o=o?n.clone(o):{},this.changed=!0,n.each(this.getReverseRelations(e),function(e){e.removeRelated(this.instance,null,o)},this);var r=this;!o.silent&&t.Relational.eventQueue.add(function(){r.instance.trigger("remove:"+r.key,e,r.related,o)})},handleReset:function(e,i){var o=this;i=i?n.clone(i):{},!i.silent&&t.Relational.eventQueue.add(function(){o.instance.trigger("reset:"+o.key,o.related,i)})},tryAddRelated:function(e,t,i){var o=n.contains(this.keyIds,e.id);o&&(this.addRelated(e,i),this.keyIds=n.without(this.keyIds,e.id))},addRelated:function(e,t){var i=this;e.queue(function(){i.related&&!i.related.get(e)&&i.related.add(e,n.defaults({parse:!1},t))})},removeRelated:function(e,t,n){this.related.get(e)&&this.related.remove(e,n)}}),t.RelationalModel=t.Model.extend({relations:null,_relations:null,_isInitialized:!1,_deferProcessing:!1,_queue:null,_attributeChangeFired:!1,subModelTypeAttribute:"type",subModelTypes:null,constructor:function(e,i){if(i&&i.collection){var o=this,r=this.collection=i.collection;delete i.collection,this._deferProcessing=!0;var s=function(e){e===o&&(o._deferProcessing=!1,o.processQueue(),r.off("relational:add",s))};r.on("relational:add",s),n.defer(function(){s(o)})}t.Relational.store.processOrphanRelations(),t.Relational.store.listenTo(this,"relational:unregister",t.Relational.store.unregister),this._queue=new t.BlockingQueue,this._queue.block(),t.Relational.eventQueue.block();try{t.Model.apply(this,arguments)}finally{t.Relational.eventQueue.unblock()}},trigger:function(e){if(e.length>5&&0===e.indexOf("change")){var n=this,i=arguments;t.Relational.eventQueue.isLocked()?t.Relational.eventQueue.add(function(){var o=!0;if("change"===e)o=n.hasChanged()||n._attributeChangeFired,n._attributeChangeFired=!1;else{var r=e.slice(7),s=n.getRelation(r);s?(o=i[4]===!0,o?n.changed[r]=i[2]:s.changed||delete n.changed[r]):o&&(n._attributeChangeFired=!0)}o&&t.Model.prototype.trigger.apply(n,i)}):t.Model.prototype.trigger.apply(n,i)}else"destroy"===e?(t.Model.prototype.trigger.apply(this,arguments),t.Relational.store.unregister(this)):t.Model.prototype.trigger.apply(this,arguments);return this},initializeRelations:function(e){this.acquire(),this._relations={},n.each(this.relations||[],function(n){t.Relational.store.initializeRelation(this,n,e)},this),this._isInitialized=!0,this.release(),this.processQueue()},updateRelations:function(e,t){this._isInitialized&&!this.isLocked()&&n.each(this._relations,function(n){if(!e||n.keySource in e||n.key in e){var i=this.attributes[n.keySource]||this.attributes[n.key],o=e&&(e[n.keySource]||e[n.key]);(n.related!==i||null===i&&null===o)&&this.trigger("relational:change:"+n.key,this,i,t||{})}n.keySource!==n.key&&delete this.attributes[n.keySource]},this)},queue:function(e){this._queue.add(e)},processQueue:function(){this._isInitialized&&!this._deferProcessing&&this._queue.isBlocked()&&this._queue.unblock()},getRelation:function(e){return this._relations[e]},getRelations:function(){return n.values(this._relations)},getIdsToFetch:function(e,i){
var o=e instanceof t.Relation?e:this.getRelation(e),r=o?o.keyIds&&o.keyIds.slice(0)||(o.keyId||0===o.keyId?[o.keyId]:[]):[];if(i){var s=o.related&&(o.related.models||[o.related]);n.each(s,function(e){(e.id||0===e.id)&&r.push(e.id)})}return r},getAsync:function(e,i){i=n.extend({add:!0,remove:!1,refresh:!1},i);var o=this,r=[],s=this.getRelation(e),a=s&&this.getIdsToFetch(s,i.refresh),l=s.related instanceof t.Collection?s.related:s.relatedCollection;if(a&&a.length){var u,c=[],f=[],h=function(){c=n.map(a,function(e){var t=s.relatedModel.findModel(e);if(!t){var n={};n[s.relatedModel.prototype.idAttribute]=e,t=s.relatedModel.findOrCreate(n,i),f.push(t)}return t},this)};if(l instanceof t.Collection&&n.isFunction(l.url)){var d=l.url();u=l.url(a),u===d&&(h(),u=l.url(c),u===d&&(u=null))}if(u){var p=n.defaults({error:function(){n.each(f,function(e){e.trigger("destroy",e,e.collection,i)}),i.error&&i.error.apply(c,arguments)},url:u},i);r=[l.fetch(p)]}else c.length||h(),r=n.map(c,function(e){var t=n.defaults({error:function(){n.contains(f,e)&&e.trigger("destroy",e,e.collection,i),i.error&&i.error.apply(c,arguments)}},i);return e.fetch(t)},this)}return $.when.apply(null,r).then(function(){return t.Model.prototype.get.call(o,e)})},set:function(e,i,o){t.Relational.eventQueue.block();var r,s;n.isObject(e)||null==e?(r=e,o=i):(r={},r[e]=i);try{var a=this.id,l=r&&this.idAttribute in r&&r[this.idAttribute];t.Relational.store.checkId(this,l),s=t.Model.prototype.set.apply(this,arguments),this._isInitialized||this.isLocked()?l&&l!==a&&t.Relational.store.update(this):(this.constructor.initializeModelHierarchy(),(l||0===l)&&t.Relational.store.register(this),this.initializeRelations(o)),r&&this.updateRelations(r,o)}finally{t.Relational.eventQueue.unblock()}return s},clone:function(){var e=n.clone(this.attributes);return n.isUndefined(e[this.idAttribute])||(e[this.idAttribute]=null),n.each(this.getRelations(),function(t){delete e[t.key]}),new this.constructor(e)},toJSON:function(e){if(this.isLocked())return this.id;this.acquire();var i=t.Model.prototype.toJSON.call(this,e);return!this.constructor._superModel||this.constructor._subModelTypeAttribute in i||(i[this.constructor._subModelTypeAttribute]=this.constructor._subModelTypeValue),n.each(this._relations,function(o){var r=i[o.key],s=o.options.includeInJSON,a=null;s===!0?r&&n.isFunction(r.toJSON)&&(a=r.toJSON(e)):n.isString(s)?(r instanceof t.Collection?a=r.pluck(s):r instanceof t.Model&&(a=r.get(s)),s===o.relatedModel.prototype.idAttribute&&(o instanceof t.HasMany?a=a.concat(o.keyIds):o instanceof t.HasOne&&(a=a||o.keyId,a||n.isObject(o.keyContents)||(a=o.keyContents||null)))):n.isArray(s)?r instanceof t.Collection?(a=[],r.each(function(e){var t={};n.each(s,function(n){t[n]=e.get(n)}),a.push(t)})):r instanceof t.Model&&(a={},n.each(s,function(e){a[e]=r.get(e)})):delete i[o.key],null===a&&e&&e.wait&&(a=r),s&&(i[o.keyDestination]=a),o.keyDestination!==o.key&&delete i[o.key]}),this.release(),i}},{setup:function(e){return this.prototype.relations=(this.prototype.relations||[]).slice(0),this._subModels={},this._superModel=null,this.prototype.hasOwnProperty("subModelTypes")?t.Relational.store.addSubModels(this.prototype.subModelTypes,this):this.prototype.subModelTypes=null,n.each(this.prototype.relations||[],function(e){if(e.model||(e.model=this),e.reverseRelation&&e.model===this){var i=!0;if(n.isString(e.relatedModel)){var o=t.Relational.store.getObjectByName(e.relatedModel);i=o&&o.prototype instanceof t.RelationalModel}i?t.Relational.store.initializeRelation(null,e):n.isString(e.relatedModel)&&t.Relational.store.addOrphanRelation(e)}},this),this},build:function(e,t){this.initializeModelHierarchy();var n=this._findSubModelType(this,e)||this;return new n(e,t)},_findSubModelType:function(e,t){if(e._subModels&&e.prototype.subModelTypeAttribute in t){var n=t[e.prototype.subModelTypeAttribute],i=e._subModels[n];if(i)return i;for(n in e._subModels)if(i=this._findSubModelType(e._subModels[n],t))return i}return null},initializeModelHierarchy:function(){if(this.inheritRelations(),this.prototype.subModelTypes){var e=n.keys(this._subModels),i=n.omit(this.prototype.subModelTypes,e);n.each(i,function(e){var n=t.Relational.store.getObjectByName(e);n&&n.initializeModelHierarchy()})}},inheritRelations:function(){if(n.isUndefined(this._superModel)||n.isNull(this._superModel))if(t.Relational.store.setupSuperModel(this),this._superModel){if(this._superModel.inheritRelations(),this._superModel.prototype.relations){var e=n.filter(this._superModel.prototype.relations||[],function(e){return!n.any(this.prototype.relations||[],function(t){return e.relatedModel===t.relatedModel&&e.key===t.key},this)},this);this.prototype.relations=e.concat(this.prototype.relations)}}else this._superModel=!1},findOrCreate:function(e,t){t||(t={});var i=n.isObject(e)&&t.parse&&this.prototype.parse?this.prototype.parse(n.clone(e)):e,o=this.findModel(i);return n.isObject(e)&&(o&&t.merge!==!1?(delete t.collection,delete t.url,o.set(i,t)):o||t.create===!1||(o=this.build(i,n.defaults({parse:!1},t)))),o},find:function(e,t){return t||(t={}),t.create=!1,this.findOrCreate(e,t)},findModel:function(e){return t.Relational.store.find(this,e)}}),n.extend(t.RelationalModel.prototype,t.Semaphore),t.Collection.prototype.__prepareModel=t.Collection.prototype._prepareModel,t.Collection.prototype._prepareModel=function(e,i){var o;return e instanceof t.Model?(e.collection||(e.collection=this),o=e):(i=i?n.clone(i):{},i.collection=this,o="undefined"!=typeof this.model.findOrCreate?this.model.findOrCreate(e,i):new this.model(e,i),o&&o.validationError&&(this.trigger("invalid",this,e,i),o=!1)),o};var i=t.Collection.prototype.__set=t.Collection.prototype.set;t.Collection.prototype.set=function(e,o){if(!(this.model.prototype instanceof t.RelationalModel))return i.call(this,e,o);o&&o.parse&&(e=this.parse(e,o));var r=!n.isArray(e),s=[],a=[],l=null;e=r?e?[e]:[]:n.clone(e);for(var u=0;u<e.length;u++)l=e[u],l instanceof t.Model||(l=t.Collection.prototype._prepareModel.call(this,l,o)),l&&(a.push(l),this.get(l)||this.get(l.cid)?null!==l.id&&void 0!==l.id&&(this._byId[l.id]=l):s.push(l));a=r?a.length?a[0]:null:a;var c=i.call(this,a,n.defaults({merge:!1,parse:!1},o));for(u=0;u<s.length;u++)l=s[u],(this.get(l)||this.get(l.cid))&&this.trigger("relational:add",l,this,o);return c};var o=t.Collection.prototype.__remove=t.Collection.prototype.remove;t.Collection.prototype.remove=function(e,i){if(!(this.model.prototype instanceof t.RelationalModel))return o.call(this,e,i);var r=!n.isArray(e),s=[];e=r?e?[e]:[]:n.clone(e),i||(i={}),n.each(e,function(e){e=this.get(e)||e&&this.get(e.cid),e&&s.push(e)},this);var a=o.call(this,r?s.length?s[0]:null:s,i);return n.each(s,function(e){this.trigger("relational:remove",e,this,i)},this),a};var r=t.Collection.prototype.__reset=t.Collection.prototype.reset;t.Collection.prototype.reset=function(e,i){i=n.extend({merge:!0},i);var o=r.call(this,e,i);return this.model.prototype instanceof t.RelationalModel&&this.trigger("relational:reset",this,i),o};var s=t.Collection.prototype.__sort=t.Collection.prototype.sort;t.Collection.prototype.sort=function(e){var n=s.call(this,e);return this.model.prototype instanceof t.RelationalModel&&this.trigger("relational:reset",this,e),n};var a=t.Collection.prototype.__trigger=t.Collection.prototype.trigger;t.Collection.prototype.trigger=function(e){if(!(this.model.prototype instanceof t.RelationalModel))return a.apply(this,arguments);if("add"===e||"remove"===e||"reset"===e||"sort"===e){var i=this,o=arguments;n.isObject(o[3])&&(o=n.toArray(o),o[3]=n.clone(o[3])),t.Relational.eventQueue.add(function(){a.apply(i,o)})}else a.apply(this,arguments);return this},t.RelationalModel.extend=function(e,n){var i=t.Model.extend.call(this,e,n);return i.setup(this),i}}),function(e){function t(t,o){var r,s,a,l=this,u=t.add(l),c=e(window),f=e.tools.expose&&(o.mask||o.expose),h=Math.random().toString().slice(10);f&&("string"==typeof f&&(f={color:f}),f.closeOnClick=f.closeOnEsc=!1);var d=o.target||t.attr("rel");if(s=d?e(d):t,!s.length)throw"Could not find Overlay: "+d;t&&-1==t.index(s)&&t.click(function(e){return l.load(e),e.preventDefault()}),e.extend(l,{load:function(t){if(l.isOpened())return l;var r=i[o.effect];if(!r)throw'Overlay: cannot find effect : "'+o.effect+'"';if(o.oneInstance&&e.each(n,function(){this.close(t)}),t=t||e.Event(),t.type="onBeforeLoad",u.trigger(t),t.isDefaultPrevented())return l;a=!0,f&&e(s).expose(f);var d=o.top,p=o.left,g=s.outerWidth(!0),v=s.outerHeight(!0);return"string"==typeof d&&(d="center"==d?Math.max((c.height()-v)/2,0):parseInt(d,10)/100*c.height()),"center"==p&&(p=Math.max((c.width()-g)/2,0)),r[0].call(l,{top:d,left:p},function(){a&&(t.type="onLoad",u.trigger(t))}),f&&o.closeOnClick&&e.mask.getMask().one("click",l.close),o.closeOnClick&&e(document).on("click."+h,function(t){e(t.target).parents(s).length||l.close(t)}),o.closeOnEsc&&e(document).on("keydown."+h,function(e){27==e.keyCode&&l.close(e)}),l},close:function(t){return l.isOpened()?(t=t||e.Event(),t.type="onBeforeClose",u.trigger(t),t.isDefaultPrevented()?void 0:(a=!1,i[o.effect][1].call(l,function(){t.type="onClose",u.trigger(t)}),e(document).off("click."+h+" keydown."+h),f&&e.mask.close(),l)):l},getOverlay:function(){return s},getTrigger:function(){return t},getClosers:function(){return r},isOpened:function(){return a},getConf:function(){return o}}),e.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(t,n){e.isFunction(o[n])&&e(l).on(n,o[n]),l[n]=function(t){return t&&e(l).on(n,t),l}}),r=s.find(o.close||".close"),r.length||o.close||(r=e('<a class="close"></a>'),s.prepend(r)),r.click(function(e){l.close(e)}),o.load&&l.load()}e.tools=e.tools||{version:"@VERSION"},e.tools.overlay={addEffect:function(e,t,n){i[e]=[t,n]},conf:{close:null,closeOnClick:!0,closeOnEsc:!0,closeSpeed:"fast",effect:"default",fixed:!0,left:"center",load:!1,mask:null,oneInstance:!0,speed:"normal",target:null,top:"10%"}};var n=[],i={};e.tools.overlay.addEffect("default",function(t,n){var i=this.getConf(),o=e(window);i.fixed||(t.top+=o.scrollTop(),t.left+=o.scrollLeft()),t.position=i.fixed?"fixed":"absolute",this.getOverlay().css(t).fadeIn(i.speed,n)},function(e){this.getOverlay().fadeOut(this.getConf().closeSpeed,e)}),e.fn.overlay=function(i){var o=this.data("overlay");return o?o:(e.isFunction(i)&&(i={onBeforeLoad:i}),i=e.extend(!0,{},e.tools.overlay.conf,i),this.each(function(){o=new t(e(this),i),n.push(o),e(this).data("overlay",o)}),i.api?o:this)}}(jQuery),function(e){function t(){return[e(document).width(),e(document).height()]}function n(t){return t?t.call(e.mask):void 0}e.tools=e.tools||{version:"@VERSION"};var i;i=e.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:!0,closeOnEsc:!0,zIndex:9998,opacity:.8,startOpacity:0,color:"#fff",onLoad:null,onClose:null}};var o,r,s,a,l;e.mask={load:function(u,c){if(s)return this;"string"==typeof u&&(u={color:u}),u=u||a,a=u=e.extend(e.extend({},i.conf),u),o=e("#"+u.maskId),o.length||(o=e("<div/>").attr("id",u.maskId),e("body").append(o));var f=t();return o.css({position:"absolute",top:0,left:0,width:f[0],height:f[1],display:"none",opacity:u.startOpacity,zIndex:u.zIndex}),u.color&&o.css("backgroundColor",u.color),n(u.onBeforeLoad)===!1?this:(u.closeOnEsc&&e(document).on("keydown.mask",function(t){27==t.keyCode&&e.mask.close(t)}),u.closeOnClick&&o.on("click.mask",function(t){e.mask.close(t)}),e(window).on("resize.mask",function(){e.mask.fit()}),c&&c.length&&(l=c.eq(0).css("zIndex"),e.each(c,function(){var t=e(this);/relative|absolute|fixed/i.test(t.css("position"))||t.css("position","relative")}),r=c.css({zIndex:Math.max(u.zIndex+1,"auto"==l?0:l)})),o.css({display:"block"}).fadeTo(u.loadSpeed,u.opacity,function(){e.mask.fit(),n(u.onLoad),s="full"}),s=!0,this)},close:function(){if(s){if(n(a.onBeforeClose)===!1)return this;o.fadeOut(a.closeSpeed,function(){n(a.onClose),r&&r.css({zIndex:l}),s=!1}),e(document).off("keydown.mask"),o.off("click.mask"),e(window).off("resize.mask")}return this},fit:function(){if(s){var e=t();o.css({width:e[0],height:e[1]})}},getMask:function(){return o},isLoaded:function(e){return e?"full"==s:s},getConf:function(){return a},getExposed:function(){return r}},e.fn.mask=function(t){return e.mask.load(t),this},e.fn.expose=function(t){return e.mask.load(t,this),this}}(jQuery),function(e){function t(t,n){var i=e(n);return i.length<2?i:t.parent().find(n)}function n(n,o){var r=this,s=n.add(r),a=n.children(),l=0,u=o.vertical;if(i||(i=r),a.length>1&&(a=e(o.items,n)),o.size>1&&(o.circular=!1),e.extend(r,{getConf:function(){return o},getIndex:function(){return l},getSize:function(){return r.getItems().size()},getNaviButtons:function(){return d.add(p)},getRoot:function(){return n},getItemWrap:function(){return a},getItems:function(){return a.find(o.item).not("."+o.clonedClass)},move:function(e,t){return r.seekTo(l+e,t)},next:function(e){return r.move(o.size,e)},prev:function(e){return r.move(-o.size,e)},begin:function(e){return r.seekTo(0,e)},end:function(e){return r.seekTo(r.getSize()-1,e)},focus:function(){return i=r,r},addItem:function(t){return t=e(t),o.circular?(a.children().last().before(t),a.children().first().replaceWith(t.clone().addClass(o.clonedClass))):(a.append(t),p.removeClass("disabled")),s.trigger("onAddItem",[t]),r},seekTo:function(t,n,c){if(t.jquery||(t*=1),o.circular&&0===t&&-1==l&&0!==n)return r;if(!o.circular&&0>t||t>r.getSize()||-1>t)return r;var f=t;t.jquery?t=r.getItems().index(t):f=r.getItems().eq(t);var h=e.Event("onBeforeSeek");if(!c&&(s.trigger(h,[t,n]),h.isDefaultPrevented()||!f.length))return r;var d=u?{top:-f.position().top}:{left:-f.position().left};return l=t,i=r,void 0===n&&(n=o.speed),a.animate(d,n,o.easing,c||function(){s.trigger("onSeek",[t])}),r}}),e.each(["onBeforeSeek","onSeek","onAddItem"],function(t,n){e.isFunction(o[n])&&e(r).on(n,o[n]),r[n]=function(t){return t&&e(r).on(n,t),r}}),o.circular){var c=r.getItems().slice(-1).clone().prependTo(a),f=r.getItems().eq(1).clone().appendTo(a);c.add(f).addClass(o.clonedClass),r.onBeforeSeek(function(e,t,n){return e.isDefaultPrevented()?void 0:-1==t?(r.seekTo(c,n,function(){r.end(0)}),e.preventDefault()):void(t==r.getSize()&&r.seekTo(f,n,function(){r.begin(0)}))});var h=n.parents().add(n).filter(function(){return"none"===e(this).css("display")?!0:void 0});h.length?(h.show(),r.seekTo(0,0,function(){}),h.hide()):r.seekTo(0,0,function(){})}var d=t(n,o.prev).click(function(e){e.stopPropagation(),r.prev()}),p=t(n,o.next).click(function(e){e.stopPropagation(),r.next()});if(o.circular||(r.onBeforeSeek(function(e,t){setTimeout(function(){e.isDefaultPrevented()||(d.toggleClass(o.disabledClass,0>=t),p.toggleClass(o.disabledClass,t>=r.getSize()-1))},1)}),o.initialIndex||d.addClass(o.disabledClass)),r.getSize()<2&&d.add(p).addClass(o.disabledClass),o.mousewheel&&e.fn.mousewheel&&n.mousewheel(function(e,t){return o.mousewheel?(r.move(0>t?1:-1,o.wheelSpeed||50),!1):void 0}),o.touch){var g={};a[0].ontouchstart=function(e){var t=e.touches[0];g.x=t.clientX,g.y=t.clientY},a[0].ontouchmove=function(e){if(1==e.touches.length&&!a.is(":animated")){var t=e.touches[0],n=g.x-t.clientX,i=g.y-t.clientY;r[u&&i>0||!u&&n>0?"next":"prev"](),e.preventDefault()}}}o.keyboard&&e(document).on("keydown.scrollable",function(t){if(!(!o.keyboard||t.altKey||t.ctrlKey||t.metaKey||e(t.target).is(":input")||"static"!=o.keyboard&&i!=r)){var n=t.keyCode;return!u||38!=n&&40!=n?u||37!=n&&39!=n?void 0:(r.move(37==n?-1:1),t.preventDefault()):(r.move(38==n?-1:1),t.preventDefault())}}),o.initialIndex&&r.seekTo(o.initialIndex,0,function(){})}e.tools=e.tools||{version:"@VERSION"},e.tools.scrollable={conf:{activeClass:"active",circular:!1,clonedClass:"cloned",disabledClass:"disabled",easing:"swing",initialIndex:0,item:"> *",items:".items",keyboard:!0,mousewheel:!1,next:".next",prev:".prev",size:1,speed:400,vertical:!1,touch:!0,wheelSpeed:0}};var i;e.fn.scrollable=function(t){var i=this.data("scrollable");return i?i:(t=e.extend({},e.tools.scrollable.conf,t),this.each(function(){i=new n(e(this),t),e(this).data("scrollable",i)}),t.api?i:this)}}(jQuery),function(e){function t(t,n){var i=e(n);return i.length<2?i:t.parent().find(n)}var n=e.tools.scrollable;n.navigator={conf:{navi:".navi",naviItem:null,activeClass:"active",indexed:!1,idPrefix:null,history:!1}},e.fn.navigator=function(i){"string"==typeof i&&(i={navi:i}),i=e.extend({},n.navigator.conf,i);var o;return this.each(function(){function n(e,t,n){a.seekTo(t),n.preventDefault(),f&&history.pushState({i:t},"")}function r(){return l.find(i.naviItem||"> *")}function s(t){var o=e("<"+(i.naviItem||"a")+"/>").click(function(i){n(e(this),t,i)});return 0===t&&o.addClass(c),i.indexed&&o.text(t+1),i.idPrefix&&o.attr("id",i.idPrefix+t),o.appendTo(l)}var a=e(this).data("scrollable"),l=i.navi.jquery?i.navi:t(a.getRoot(),i.navi),u=a.getNaviButtons(),c=i.activeClass,f=i.history&&!!history.pushState,h=a.getConf().size;a&&(o=a),a.getNaviButtons=function(){return u.add(l)},f&&(history.pushState({i:0},""),e(window).on("popstate",function(e){var t=e.originalEvent.state;t&&a.seekTo(t.i)})),r().length?r().each(function(t){e(this).click(function(i){n(e(this),t,i)})}):e.each(a.getItems(),function(e){e%h==0&&s(e)}),a.onBeforeSeek(function(e,t){setTimeout(function(){if(!e.isDefaultPrevented()){var n=t/h,i=r().eq(n);i.length&&r().removeClass(c).eq(n).addClass(c)}},1)}),a.onAddItem(function(e,t){var n=a.getItems().index(t);n%h==0&&s(n)})}),i.api?o:this}}(jQuery),function(e){function t(t,n,i){var r,s=this,a=t.add(this),l=t.find(i.tabs),u=n.jquery?n:t.children(n);l.length||(l=t.children()),u.length||(u=t.parent().find(n)),u.length||(u=e(n)),e.extend(this,{click:function(n,u){var c=l.eq(n),f=!t.data("tabs");if("string"==typeof n&&n.replace("#","")&&(c=l.filter('[href*="'+n.replace("#","")+'"]'),n=Math.max(l.index(c),0)),i.rotate){var h=l.length-1;if(0>n)return s.click(h,u);if(n>h)return s.click(0,u)}if(!c.length){if(r>=0)return s;n=i.initialIndex,c=l.eq(n)}if(n===r)return s;if(u=u||e.Event(),u.type="onBeforeClick",a.trigger(u,[n]),!u.isDefaultPrevented()){var d=f?i.initialEffect&&i.effect||"default":i.effect;return r=n,o[d].call(s,n,function(){u.type="onClick",a.trigger(u,[n])}),l.removeClass(i.current),c.addClass(i.current),s}},getConf:function(){return i},getTabs:function(){return l},getPanes:function(){return u},getCurrentPane:function(){return u.eq(r)},getCurrentTab:function(){return l.eq(r)},getIndex:function(){return r},next:function(){return s.click(r+1)},prev:function(){return s.click(r-1)},destroy:function(){return l.off(i.event).removeClass(i.current),u.find('a[href^="#"]').off("click.T"),s}}),e.each("onBeforeClick,onClick".split(","),function(t,n){e.isFunction(i[n])&&e(s).on(n,i[n]),s[n]=function(t){return t&&e(s).on(n,t),s}}),i.history&&e.fn.history&&(e.tools.history.init(l),i.event="history"),l.each(function(t){e(this).on(i.event,function(e){return s.click(t,e),e.preventDefault()})}),u.find('a[href^="#"]').on("click.T",function(t){s.click(e(this).attr("href"),t)}),location.hash&&"a"==i.tabs&&t.find('[href="'+location.hash+'"]').length?s.click(location.hash):(0===i.initialIndex||i.initialIndex>0)&&s.click(i.initialIndex)}e.tools=e.tools||{version:"@VERSION"},e.tools.tabs={conf:{tabs:"a",current:"current",onBeforeClick:null,onClick:null,effect:"default",initialEffect:!1,initialIndex:0,event:"click",rotate:!1,slideUpSpeed:400,slideDownSpeed:400,history:!1},addEffect:function(e,t){o[e]=t}};var n,i,o={"default":function(e,t){this.getPanes().hide().eq(e).show(),t.call()},fade:function(e,t){var n=this.getConf(),i=n.fadeOutSpeed,o=this.getPanes();i?o.fadeOut(i):o.hide(),o.eq(e).fadeIn(n.fadeInSpeed,t)},slide:function(e,t){var n=this.getConf();this.getPanes().slideUp(n.slideUpSpeed),this.getPanes().eq(e).slideDown(n.slideDownSpeed,t)},ajax:function(e,t){this.getPanes().eq(0).load(this.getTabs().eq(e).attr("href"),t)}};e.tools.tabs.addEffect("horizontal",function(t,o){if(!n){var r=this.getPanes().eq(t),s=this.getCurrentPane();i||(i=this.getPanes().eq(0).width()),n=!0,r.show(),s.animate({width:0},{step:function(e){r.css("width",i-e)},complete:function(){e(this).hide(),o.call(),n=!1}}),s.length||(o.call(),n=!1)}}),e.fn.tabs=function(n,i){var o=this.data("tabs");return o&&(o.destroy(),this.removeData("tabs")),e.isFunction(i)&&(i={onBeforeClick:i}),i=e.extend({},e.tools.tabs.conf,i),this.each(function(){o=new t(e(this),n,i),e(this).data("tabs",o)}),i.api?o:this}}(jQuery),function(e){function t(t,n){function i(n){var i=e(n);return i.length<2?i:t.parent().find(n)}function o(){r=setTimeout(function(){l.next()},n.interval)}var r,s=this,a=t.add(this),l=t.data("tabs"),u=!0,c=i(n.next).click(function(){l.next()}),f=i(n.prev).click(function(){l.prev()});if(e.extend(s,{getTabs:function(){return l},getConf:function(){return n},play:function(){if(r)return s;var t=e.Event("onBeforePlay");return a.trigger(t),t.isDefaultPrevented()?s:(u=!1,a.trigger("onPlay"),a.on("onClick",o),o(),s)},pause:function(){if(!r)return s;var t=e.Event("onBeforePause");return a.trigger(t),t.isDefaultPrevented()?s:(r=clearTimeout(r),a.trigger("onPause"),a.off("onClick",o),s)},resume:function(){u||s.play()},stop:function(){s.pause(),u=!0}}),e.each("onBeforePlay,onPlay,onBeforePause,onPause".split(","),function(t,i){e.isFunction(n[i])&&e(s).on(i,n[i]),s[i]=function(t){return e(s).on(i,t)}}),n.autopause&&l.getTabs().add(c).add(f).add(l.getPanes()).hover(s.pause,s.resume),n.autoplay&&s.play(),n.clickable&&l.getPanes().click(function(){l.next()}),!l.getConf().rotate){var h=n.disabledClass;l.getIndex()||f.addClass(h),l.onBeforeClick(function(e,t){f.toggleClass(h,!t),c.toggleClass(h,t==l.getTabs().length-1)})}}var n;n=e.tools.tabs.slideshow={conf:{next:".forward",prev:".backward",disabledClass:"disabled",autoplay:!1,autopause:!0,interval:3e3,clickable:!0,api:!1}},e.fn.slideshow=function(i){var o=this.data("slideshow");return o?o:(i=e.extend({},n.conf,i),this.each(function(){o=new t(e(this),i),e(this).data("slideshow",o)}),i.api?o:this)}}(jQuery),function(e){e.fn.hoverIntent=function(t,n,i){var o={interval:100,sensitivity:6,timeout:0};o="object"==typeof t?e.extend(o,t):e.isFunction(n)?e.extend(o,{over:t,out:n,selector:i}):e.extend(o,{over:t,out:t,selector:n});var r,s,a,l,u=function(e){r=e.pageX,s=e.pageY},c=function(t,n){return n.hoverIntent_t=clearTimeout(n.hoverIntent_t),Math.sqrt((a-r)*(a-r)+(l-s)*(l-s))<o.sensitivity?(e(n).off("mousemove.hoverIntent",u),n.hoverIntent_s=!0,o.over.apply(n,[t])):(a=r,l=s,n.hoverIntent_t=setTimeout(function(){c(t,n)},o.interval),void 0)},f=function(e,t){return t.hoverIntent_t=clearTimeout(t.hoverIntent_t),t.hoverIntent_s=!1,o.out.apply(t,[e])},h=function(t){var n=e.extend({},t),i=this;i.hoverIntent_t&&(i.hoverIntent_t=clearTimeout(i.hoverIntent_t)),"mouseenter"===t.type?(a=n.pageX,l=n.pageY,e(i).on("mousemove.hoverIntent",u),i.hoverIntent_s||(i.hoverIntent_t=setTimeout(function(){c(n,i)},o.interval))):(e(i).off("mousemove.hoverIntent",u),i.hoverIntent_s&&(i.hoverIntent_t=setTimeout(function(){f(n,i)},o.timeout)))};return this.on({"mouseenter.hoverIntent":h,"mouseleave.hoverIntent":h},o.selector)}}(jQuery),function(e){e.extend({placeholder:{settings:{focusClass:"placeholderFocus",activeClass:"placeholder",overrideSupport:!1,preventRefreshIssues:!0},debug:!1,log:function(t){e.placeholder.debug&&(t="[Placeholder] "+t,e.placeholder.hasFirebug?console.log(t):e.placeholder.hasConsoleLog?window.console.log(t):alert(t))},hasFirebug:"console"in window&&"firebug"in window.console,hasConsoleLog:"console"in window&&"log"in window.console}}),e.support.placeholder="placeholder"in document.createElement("input"),e.fn.plVal=e.fn.val,e.fn.val=function(t){if(e.placeholder.log("in val"),this[0]){e.placeholder.log("have found an element");var n=e(this[0]);if(void 0!=t){e.placeholder.log("in setter");var i=n.plVal(),o=e(this).plVal(t);return n.hasClass(e.placeholder.settings.activeClass)&&i==n.attr("placeholder")&&n.removeClass(e.placeholder.settings.activeClass),o}return n.hasClass(e.placeholder.settings.activeClass)&&n.plVal()==n.attr("placeholder")?(e.placeholder.log("returning empty because it's a placeholder"),""):(e.placeholder.log("returning original val"),n.plVal())}return void e.placeholder.log("returning undefined")},e(window).bind("beforeunload.placeholder",function(){var t=e("input."+e.placeholder.settings.activeClass);t.length>0&&t.val("").attr("autocomplete","off")}),e.fn.placeholder=function(t){return t=e.extend({},e.placeholder.settings,t),!t.overrideSupport&&e.support.placeholder?this:this.each(function(){var n=e(this);n.is("[placeholder]")&&(n.is(":password")||(t.preventRefreshIssues&&n.attr("autocomplete","off"),n.bind("focus.placeholder",function(){var n=e(this);this.value==n.attr("placeholder")&&n.hasClass(t.activeClass)&&n.val("").removeClass(t.activeClass).addClass(t.focusClass)}),n.bind("blur.placeholder",function(){var n=e(this);n.removeClass(t.focusClass),""==this.value&&n.val(n.attr("placeholder")).addClass(t.activeClass)}),n.triggerHandler("blur"),n.parents("form").submit(function(){n.triggerHandler("focus.placeholder")})))})}}(jQuery),function(){var e=jQuery.event.special,t="D"+ +new Date,n="D"+(+new Date+1);e.scrollstart={setup:function(){var n,i=function(t){var i=this,o=arguments;n?clearTimeout(n):(t.type="scrollstart",jQuery.event.dispatch.apply(i,o)),n=setTimeout(function(){n=null},e.scrollstop.latency)};jQuery(this).bind("scroll",i).data(t,i)},teardown:function(){jQuery(this).unbind("scroll",jQuery(this).data(t))}},e.scrollstop={latency:200,setup:function(){var t,i=function(n){var i=this,o=arguments;t&&clearTimeout(t),t=setTimeout(function(){t=null,n.type="scrollstop",jQuery.event.dispatch.apply(i,o)},e.scrollstop.latency)};jQuery(this).bind("scroll",i).data(n,i)},teardown:function(){jQuery(this).unbind("scroll",jQuery(this).data(n))}}}(),!function(e){e.jGrowl=function(t,n){0===e("#jGrowl").size()&&e('<div id="jGrowl"></div>').addClass(n&&n.position?n.position:e.jGrowl.defaults.position).appendTo("body"),e("#jGrowl").jGrowl(t,n)},e.fn.jGrowl=function(t,n){if(void 0===n&&e.isPlainObject(t)&&(n=t,t=n.message),e.isFunction(this.each)){var i=arguments;return this.each(function(){void 0===e(this).data("jGrowl.instance")&&(e(this).data("jGrowl.instance",e.extend(new e.fn.jGrowl,{notifications:[],element:null,interval:null})),e(this).data("jGrowl.instance").startup(this)),e.isFunction(e(this).data("jGrowl.instance")[t])?e(this).data("jGrowl.instance")[t].apply(e(this).data("jGrowl.instance"),e.makeArray(i).slice(1)):e(this).data("jGrowl.instance").create(t,n)})}},e.extend(e.fn.jGrowl.prototype,{defaults:{pool:0,header:"",group:"",sticky:!1,position:"top-right",glue:"after",theme:"default",themeState:"highlight",corners:"10px",check:250,life:3e3,closeDuration:"normal",openDuration:"normal",easing:"swing",closer:!0,closeTemplate:"&times;",closerTemplate:"<div>[ close all ]</div>",log:function(){},beforeOpen:function(){},afterOpen:function(){},open:function(){},beforeClose:function(){},close:function(){},click:function(){},animateOpen:{opacity:"show"},animateClose:{opacity:"hide"}},notifications:[],element:null,interval:null,create:function(t,n){var i=e.extend({},this.defaults,n);"undefined"!=typeof i.speed&&(i.openDuration=i.speed,i.closeDuration=i.speed),this.notifications.push({message:t,options:i}),i.log.apply(this.element,[this.element,t,i])},render:function(t){var n=this,i=t.message,o=t.options;o.themeState=""===o.themeState?"":"ui-state-"+o.themeState;var r=e("<div/>").addClass("jGrowl-notification alert "+o.themeState+" ui-corner-all"+(void 0!==o.group&&""!==o.group?" "+o.group:"")).append(e("<button/>").addClass("jGrowl-close").html(o.closeTemplate)).append(e("<div/>").addClass("jGrowl-header").html(o.header)).append(e("<div/>").addClass("jGrowl-message").html(i)).data("jGrowl",o).addClass(o.theme).children(".jGrowl-close").bind("click.jGrowl",function(){return e(this).parent().trigger("jGrowl.beforeClose"),!1}).parent();e(r).bind("mouseover.jGrowl",function(){e(".jGrowl-notification",n.element).data("jGrowl.pause",!0)}).bind("mouseout.jGrowl",function(){e(".jGrowl-notification",n.element).data("jGrowl.pause",!1)}).bind("jGrowl.beforeOpen",function(){o.beforeOpen.apply(r,[r,i,o,n.element])!==!1&&e(this).trigger("jGrowl.open")}).bind("jGrowl.open",function(){o.open.apply(r,[r,i,o,n.element])!==!1&&("after"==o.glue?e(".jGrowl-notification:last",n.element).after(r):e(".jGrowl-notification:first",n.element).before(r),e(this).animate(o.animateOpen,o.openDuration,o.easing,function(){e.support.opacity===!1&&this.style.removeAttribute("filter"),null!==e(this).data("jGrowl")&&(e(this).data("jGrowl").created=new Date),e(this).trigger("jGrowl.afterOpen")}))}).bind("jGrowl.afterOpen",function(){o.afterOpen.apply(r,[r,i,o,n.element])}).bind("click",function(){o.click.apply(r,[r.message,o,n.element])}).bind("jGrowl.beforeClose",function(){o.beforeClose.apply(r,[r,i,o,n.element])!==!1&&e(this).trigger("jGrowl.close")}).bind("jGrowl.close",function(){e(this).data("jGrowl.pause",!0),e(this).animate(o.animateClose,o.closeDuration,o.easing,function(){e.isFunction(o.close)?o.close.apply(r,[r,i,o,n.element])!==!1&&e(this).remove():e(this).remove()})}).trigger("jGrowl.beforeOpen"),""!==o.corners&&void 0!==e.fn.corner&&e(r).corner(o.corners),e(".jGrowl-notification:parent",n.element).size()>1&&0===e(".jGrowl-closer",n.element).size()&&this.defaults.closer!==!1&&e(this.defaults.closerTemplate).addClass("jGrowl-closer "+this.defaults.themeState+" ui-corner-all").addClass(this.defaults.theme).appendTo(n.element).animate(this.defaults.animateOpen,this.defaults.speed,this.defaults.easing).bind("click.jGrowl",function(){e(this).siblings().trigger("jGrowl.beforeClose"),e.isFunction(n.defaults.closer)&&n.defaults.closer.apply(e(this).parent()[0],[e(this).parent()[0]])})},update:function(){e(this.element).find(".jGrowl-notification:parent").each(function(){void 0!==e(this).data("jGrowl")&&void 0!==e(this).data("jGrowl").created&&e(this).data("jGrowl").created.getTime()+parseInt(e(this).data("jGrowl").life,10)<(new Date).getTime()&&e(this).data("jGrowl").sticky!==!0&&(void 0===e(this).data("jGrowl.pause")||e(this).data("jGrowl.pause")!==!0)&&e(this).trigger("jGrowl.beforeClose")}),this.notifications.length>0&&(0===this.defaults.pool||e(this.element).find(".jGrowl-notification:parent").size()<this.defaults.pool)&&this.render(this.notifications.shift()),e(this.element).find(".jGrowl-notification:parent").size()<2&&e(this.element).find(".jGrowl-closer").animate(this.defaults.animateClose,this.defaults.speed,this.defaults.easing,function(){e(this).remove()})},startup:function(t){this.element=e(t).addClass("jGrowl").append('<div class="jGrowl-notification"></div>'),this.interval=setInterval(function(){e(t).data("jGrowl.instance").update()},parseInt(this.defaults.check,10))},shutdown:function(){e(this.element).removeClass("jGrowl").find(".jGrowl-notification").trigger("jGrowl.close").parent().empty(),clearInterval(this.interval)},close:function(){e(this.element).find(".jGrowl-notification").each(function(){e(this).trigger("jGrowl.beforeClose")})}}),e.jGrowl.defaults=e.fn.jGrowl.prototype.defaults}(jQuery);var Kicksend={mailcheck:{threshold:3,defaultDomains:["yahoo.com","google.com","hotmail.com","gmail.com","me.com","aol.com","mac.com","live.com","comcast.net","googlemail.com","msn.com","hotmail.co.uk","yahoo.co.uk","facebook.com","verizon.net","sbcglobal.net","att.net","gmx.com","mail.com","outlook.com","icloud.com"],defaultTopLevelDomains:["co.jp","co.uk","com","net","org","info","edu","gov","mil","ca"],run:function(e){e.domains=e.domains||Kicksend.mailcheck.defaultDomains,e.topLevelDomains=e.topLevelDomains||Kicksend.mailcheck.defaultTopLevelDomains,e.distanceFunction=e.distanceFunction||Kicksend.sift3Distance;var t=function(e){return e},n=e.suggested||t,i=e.empty||t,o=Kicksend.mailcheck.suggest(encodeURI(e.email),e.domains,e.topLevelDomains,e.distanceFunction);return o?n(o):i()},suggest:function(e,t,n,i){e=e.toLowerCase();
var o=this.splitEmail(e),r=this.findClosestDomain(o.domain,t,i);if(r){if(r!=o.domain)return{address:o.address,domain:r,full:o.address+"@"+r}}else{var s=this.findClosestDomain(o.topLevelDomain,n);if(o.domain&&s&&s!=o.topLevelDomain){var a=o.domain;return r=a.substring(0,a.lastIndexOf(o.topLevelDomain))+s,{address:o.address,domain:r,full:o.address+"@"+r}}}return!1},findClosestDomain:function(e,t,n){var i,o=99,r=null;if(!e||!t)return!1;n||(n=this.sift3Distance);for(var s=0;s<t.length;s++){if(e===t[s])return e;i=n(e,t[s]),o>i&&(o=i,r=t[s])}return o<=this.threshold&&null!==r?r:!1},sift3Distance:function(e,t){if(null==e||0===e.length)return null==t||0===t.length?0:t.length;if(null==t||0===t.length)return e.length;for(var n=0,i=0,o=0,r=0,s=5;n+i<e.length&&n+o<t.length;){if(e.charAt(n+i)==t.charAt(n+o))r++;else{i=0,o=0;for(var a=0;s>a;a++){if(n+a<e.length&&e.charAt(n+a)==t.charAt(n)){i=a;break}if(n+a<t.length&&e.charAt(n)==t.charAt(n+a)){o=a;break}}}n++}return(e.length+t.length)/2-r},splitEmail:function(e){var t=e.split("@");if(t.length<2)return!1;for(var n=0;n<t.length;n++)if(""===t[n])return!1;var i=t.pop(),o=i.split("."),r="";if(0==o.length)return!1;if(1==o.length)r=o[0];else{for(var n=1;n<o.length;n++)r+=o[n]+".";o.length>=2&&(r=r.substring(0,r.length-1))}return{topLevelDomain:r,domain:i,address:t.join("@")}}}};"undefined"!=typeof module&&module.exports&&(module.exports=Kicksend.mailcheck),"undefined"!=typeof window&&window.jQuery&&!function(e){e.fn.mailcheck=function(e){var t=this;if(e.suggested){var n=e.suggested;e.suggested=function(e){n(t,e)}}if(e.empty){var i=e.empty;e.empty=function(){i.call(null,t)}}e.email=this.val(),Kicksend.mailcheck.run(e)}}(jQuery),"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return 10>e?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,i,o,r,s,a=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(l)){for(r=l.length,n=0;r>n;n+=1)s[n]=str(n,l)||"null";return o=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+a+"]":"["+s.join(",")+"]",gap=a,o}if(rep&&"object"==typeof rep)for(r=rep.length,n=0;r>n;n+=1)"string"==typeof rep[n]&&(i=rep[n],o=str(i,l),o&&s.push(quote(i)+(gap?": ":":")+o));else for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(o=str(i,l),o&&s.push(quote(i)+(gap?": ":":")+o));return o=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+a+"}":"{"+s.join(",")+"}",gap=a,o}}var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;n>i;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,i,o=e[t];if(o&&"object"==typeof o)for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i=walk(o,n),void 0!==i?o[n]=i:delete o[n]);return reviver.call(e,t,o)}var j;if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(e){e.Jcrop=function(t,n){function i(e){return parseInt(e,10)+"px"}function o(e){return parseInt(e,10)+"%"}function r(e){return H.baseClass+"-"+e}function s(){return e.fx.step.hasOwnProperty("backgroundColor")}function a(t){var n=e(t).offset();return[n.left,n.top]}function l(e){return[e.pageX-G[0],e.pageY-G[1]]}function u(t){"object"!=typeof t&&(t={}),H=e.extend(H,t),"function"!=typeof H.onChange&&(H.onChange=function(){}),"function"!=typeof H.onSelect&&(H.onSelect=function(){}),"function"!=typeof H.onRelease&&(H.onRelease=function(){})}function c(e){e!==B&&(pe.setCursor(e),B=e)}function f(e,t){if(G=a(J),pe.setCursor("move"===e?e:e+"-resize"),"move"===e)return pe.activateHandlers(p(t),_);var n=he.getFixed(),i=g(e),o=he.getCorner(g(i));he.setPressed(he.getCorner(i)),he.setCurrent(o),pe.activateHandlers(d(e,n),_)}function d(e,t){return function(n){if(H.aspectRatio)switch(e){case"e":n[1]=t.y+1;break;case"w":n[1]=t.y+1;break;case"n":n[0]=t.x+1;break;case"s":n[0]=t.x+1}else switch(e){case"e":n[1]=t.y2;break;case"w":n[1]=t.y2;break;case"n":n[0]=t.x2;break;case"s":n[0]=t.x2}he.setCurrent(n),de.update()}}function p(e){var t=e;return ge.watchKeys(),function(e){he.moveOffset([e[0]-t[0],e[1]-t[1]]),t=e,de.update()}}function g(e){switch(e){case"n":return"sw";case"s":return"nw";case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function v(e){return function(t){return H.disabled?!1:"move"!==e||H.allowMove?(re=!0,f(e,l(t)),t.stopPropagation(),t.preventDefault(),!1):!1}}function m(e,t,n){var i=e.width(),o=e.height();i>t&&t>0&&(i=t,o=t/e.width()*e.height()),o>n&&n>0&&(o=n,i=n/e.height()*e.width()),ie=e.width()/i,oe=e.height()/o,e.width(i).height(o)}function b(e){return{x:parseInt(e.x*ie,10),y:parseInt(e.y*oe,10),x2:parseInt(e.x2*ie,10),y2:parseInt(e.y2*oe,10),w:parseInt(e.w*ie,10),h:parseInt(e.h*oe,10)}}function _(e){var t=he.getFixed();t.w>H.minSelect[0]&&t.h>H.minSelect[1]?(de.enableHandles(),de.done()):de.release(),pe.setCursor(H.allowSelect?"crosshair":"default")}function k(e){if(H.disabled)return!1;if(!H.allowSelect)return!1;re=!0,G=a(J),de.disableHandles(),c("crosshair");var t=l(e);return he.setPressed(t),de.update(),pe.activateHandlers(C,_),ge.watchKeys(),e.stopPropagation(),e.preventDefault(),!1}function C(e){he.setCurrent(e),de.update()}function R(){var t=e("<div></div>").addClass(r("tracker"));return e.browser.msie&&t.css({opacity:0,backgroundColor:"white"}),t}function j(e){K.removeClass().addClass(r("holder")).addClass(e)}function S(e,t){function n(){window.setTimeout(b,f)}var i=parseInt(e[0],10)/ie,o=parseInt(e[1],10)/oe,r=parseInt(e[2],10)/ie,s=parseInt(e[3],10)/oe;if(!se){var a=he.flipCoords(i,o,r,s),l=he.getFixed(),u=[l.x,l.y,l.x2,l.y2],c=u,f=H.animationDelay,h=a[0]-u[0],d=a[1]-u[1],p=a[2]-u[2],g=a[3]-u[3],v=0,m=H.swingSpeed;x=c[0],y=c[1],r=c[2],s=c[3],de.animMode(!0);var b=function(){return function(){v+=(100-v)/m,c[0]=x+v/100*h,c[1]=y+v/100*d,c[2]=r+v/100*p,c[3]=s+v/100*g,v>=99.8&&(v=100),100>v?(I(c),n()):(de.done(),"function"==typeof t&&t.call(ve))}}();n()}}function M(e){I([parseInt(e[0],10)/ie,parseInt(e[1],10)/oe,parseInt(e[2],10)/ie,parseInt(e[3],10)/oe])}function I(e){he.setPressed([e[0],e[1]]),he.setCurrent([e[2],e[3]]),de.update()}function O(){return b(he.getFixed())}function T(){return he.getFixed()}function E(e){u(e),F()}function A(){H.disabled=!0,de.disableHandles(),de.setCursor("default"),pe.setCursor("default")}function P(){H.disabled=!1,F()}function z(){de.done(),pe.activateHandlers(null,null)}function D(){K.remove(),L.show(),e(t).removeData("Jcrop")}function N(e,t){de.release(),A();var n=new Image;n.onload=function(){var i=n.width,o=n.height,r=H.boxWidth,s=H.boxHeight;J.width(i).height(o),J.attr("src",e),W.attr("src",e),m(J,r,s),Q=J.width(),U=J.height(),W.width(Q).height(U),ue.width(Q+2*le).height(U+2*le),K.width(Q).height(U),P(),"function"==typeof t&&t.call(ve)},n.src=e}function F(e){H.allowResize?e?de.enableOnly():de.enableHandles():de.disableHandles(),pe.setCursor(H.allowSelect?"crosshair":"default"),de.setCursor(H.allowMove?"move":"default"),H.hasOwnProperty("setSelect")&&(M(H.setSelect),de.done(),delete H.setSelect),H.hasOwnProperty("trueSize")&&(ie=H.trueSize[0]/Q,oe=H.trueSize[1]/U),H.hasOwnProperty("bgColor")&&(s()&&H.fadeTime?K.animate({backgroundColor:H.bgColor},{queue:!1,duration:H.fadeTime}):K.css("backgroundColor",H.bgColor),delete H.bgColor),H.hasOwnProperty("bgOpacity")&&(ce=H.bgOpacity,de.isAwake()&&(H.fadeTime?J.fadeTo(H.fadeTime,ce):K.css("opacity",H.opacity)),delete H.bgOpacity),Z=H.maxSize[0]||0,ee=H.maxSize[1]||0,te=H.minSize[0]||0,ne=H.minSize[1]||0,H.hasOwnProperty("outerImage")&&(J.attr("src",H.outerImage),delete H.outerImage),de.refresh()}var G,B,H=e.extend({},e.Jcrop.defaults),q=!1;e.browser.msie&&"6"===e.browser.version.split(".")[0]&&(q=!0),"object"!=typeof t&&(t=e(t)[0]),"object"!=typeof n&&(n={}),u(n);var $={border:"none",margin:0,padding:0,position:"absolute"},L=e(t),J=L.clone().removeAttr("id").css($);J.width(L.width()),J.height(L.height()),L.after(J).hide(),m(J,H.boxWidth,H.boxHeight);var Q=J.width(),U=J.height(),K=e("<div />").width(Q).height(U).addClass(r("holder")).css({position:"relative",backgroundColor:H.bgColor}).insertAfter(L).append(J);delete H.bgColor,H.addClass&&K.addClass(H.addClass);var W=e("<img />").attr("src",J.attr("src")).css($).width(Q).height(U),X=e("<div />").width(o(100)).height(o(100)).css({zIndex:310,position:"absolute",overflow:"hidden"}).append(W),V=e("<div />").width(o(100)).height(o(100)).css("zIndex",320),Y=e("<div />").css({position:"absolute",zIndex:300}).insertBefore(J).append(X,V);q&&Y.css({overflowY:"hidden"});var Z,ee,te,ne,ie,oe,re,se,ae,le=H.boundary,ue=R().width(Q+2*le).height(U+2*le).css({position:"absolute",top:i(-le),left:i(-le),zIndex:290}).mousedown(k),ce=H.bgOpacity;G=a(J);var fe=function(){function e(){var e,t={},n=["touchstart","touchmove","touchend"],i=document.createElement("div");try{for(e=0;e<n.length;e++){var o=n[e];o="on"+o;var r=o in i;r||(i.setAttribute(o,"return;"),r="function"==typeof i[o]),t[n[e]]=r}return t.touchstart&&t.touchend&&t.touchmove}catch(s){return!1}}function t(){return H.touchSupport===!0||H.touchSupport===!1?H.touchSupport:e()}return{createDragger:function(e){return function(t){return t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,H.disabled?!1:"move"!==e||H.allowMove?(re=!0,f(e,l(t)),t.stopPropagation(),t.preventDefault(),!1):!1}},newSelection:function(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,k(e)},isSupported:e,support:t()}}(),he=function(){function e(e){e=s(e),g=d=e[0],v=p=e[1]}function t(e){e=s(e),c=e[0]-g,f=e[1]-v,g=e[0],v=e[1]}function n(){return[c,f]}function i(e){var t=e[0],n=e[1];0>d+t&&(t-=t+d),0>p+n&&(n-=n+p),v+n>U&&(n+=U-(v+n)),g+t>Q&&(t+=Q-(g+t)),d+=t,g+=t,p+=n,v+=n}function o(e){var t=r();switch(e){case"ne":return[t.x2,t.y];case"nw":return[t.x,t.y];case"se":return[t.x2,t.y2];case"sw":return[t.x,t.y2]}}function r(){if(!H.aspectRatio)return l();var e,t,n=H.aspectRatio,i=H.minSize[0]/ie,o=H.maxSize[0]/ie,r=H.maxSize[1]/oe,s=g-d,c=v-p,f=Math.abs(s),y=Math.abs(c),m=f/y;return 0===o&&(o=10*Q),0===r&&(r=10*U),n>m?(t=v,w=y*n,e=0>s?d-w:w+d,0>e?(e=0,h=Math.abs((e-d)/n),t=0>c?p-h:h+p):e>Q&&(e=Q,h=Math.abs((e-d)/n),t=0>c?p-h:h+p)):(e=g,h=f/n,t=0>c?p-h:p+h,0>t?(t=0,w=Math.abs((t-p)*n),e=0>s?d-w:w+d):t>U&&(t=U,w=Math.abs(t-p)*n,e=0>s?d-w:w+d)),e>d?(i>e-d?e=d+i:e-d>o&&(e=d+o),t=t>p?p+(e-d)/n:p-(e-d)/n):d>e&&(i>d-e?e=d-i:d-e>o&&(e=d-o),t=t>p?p+(d-e)/n:p-(d-e)/n),0>e?(d-=e,e=0):e>Q&&(d-=e-Q,e=Q),0>t?(p-=t,t=0):t>U&&(p-=t-U,t=U),u(a(d,p,e,t))}function s(e){return e[0]<0&&(e[0]=0),e[1]<0&&(e[1]=0),e[0]>Q&&(e[0]=Q),e[1]>U&&(e[1]=U),[e[0],e[1]]}function a(e,t,n,i){var o=e,r=n,s=t,a=i;return e>n&&(o=n,r=e),t>i&&(s=i,a=t),[Math.round(o),Math.round(s),Math.round(r),Math.round(a)]}function l(){var e,t=g-d,n=v-p;return Z&&Math.abs(t)>Z&&(g=t>0?d+Z:d-Z),ee&&Math.abs(n)>ee&&(v=n>0?p+ee:p-ee),ne/oe&&Math.abs(n)<ne/oe&&(v=n>0?p+ne/oe:p-ne/oe),te/ie&&Math.abs(t)<te/ie&&(g=t>0?d+te/ie:d-te/ie),0>d&&(g-=d,d-=d),0>p&&(v-=p,p-=p),0>g&&(d-=g,g-=g),0>v&&(p-=v,v-=v),g>Q&&(e=g-Q,d-=e,g-=e),v>U&&(e=v-U,p-=e,v-=e),d>Q&&(e=d-U,v-=e,p-=e),p>U&&(e=p-U,v-=e,p-=e),u(a(d,p,g,v))}function u(e){return{x:e[0],y:e[1],x2:e[2],y2:e[3],w:e[2]-e[0],h:e[3]-e[1]}}var c,f,d=0,p=0,g=0,v=0;return{flipCoords:a,setPressed:e,setCurrent:t,getOffset:n,moveOffset:i,getCorner:o,getFixed:r}}(),de=function(){function t(t){var n=e("<div />").css({position:"absolute",opacity:H.borderOpacity}).addClass(r(t));return X.append(n),n}function n(t,n){var i=e("<div />").mousedown(v(t)).css({cursor:t+"-resize",position:"absolute",zIndex:n});return fe.support&&i.bind("touchstart",fe.createDragger(t)),V.append(i),i}function s(e){return n(e,j++).css({top:i(-O+1),left:i(-O+1),opacity:H.handleOpacity}).addClass(r("handle"))}function a(e){var t=H.handleSize,r=t,s=t,a=O,l=O;switch(e){case"n":case"s":s=o(100);break;case"e":case"w":r=o(100)}return n(e,j++).width(s).height(r).css({top:i(-a+1),left:i(-l+1)})}function l(e){var t;for(t=0;t<e.length;t++)M[e[t]]=s(e[t])}function u(e){var t=Math.round(e.h/2-O),n=Math.round(e.w/2-O),o=e.w-O,r=e.h-O;M.e&&(M.e.css({top:i(t),left:i(o)}),M.w.css({top:i(t)}),M.s.css({top:i(r),left:i(n)}),M.n.css({left:i(n)})),M.ne&&(M.ne.css({left:i(o)}),M.se.css({top:i(r),left:i(o)}),M.sw.css({top:i(r)})),M.b&&(M.b.css({top:i(r)}),M.r.css({left:i(o)}))}function c(e,t){W.css({top:i(-t),left:i(-e)}),Y.css({top:i(t),left:i(e)})}function f(e,t){Y.width(e).height(t)}function h(){var e=he.getFixed();he.setPressed([e.x,e.y]),he.setCurrent([e.x2,e.y2]),d()}function d(){return x?p():void 0}function p(){var e=he.getFixed();f(e.w,e.h),c(e.x,e.y),I&&u(e),x||g(),H.onChange.call(ve,b(e))}function g(){Y.show(),H.bgFade?J.fadeTo(H.fadeTime,ce):J.css("opacity",ce),x=!0}function y(){_(),Y.hide(),H.bgFade?J.fadeTo(H.fadeTime,1):J.css("opacity",1),x=!1,H.onRelease.call(ve)}function m(){I&&(u(he.getFixed()),V.show())}function w(){return I=!0,H.allowResize?(u(he.getFixed()),V.show(),!0):void 0}function _(){I=!1,V.hide()}function k(e){se===e?_():w()}function C(){k(!1),h()}var x,j=370,S={},M={},I=!1,O=H.handleOffset;H.drawBorders&&(S={top:t("hline"),bottom:t("hline bottom"),left:t("vline"),right:t("vline right")}),H.dragEdges&&(M.t=a("n"),M.b=a("s"),M.r=a("e"),M.l=a("w")),H.sideHandles&&l(["n","s","e","w"]),H.cornerHandles&&l(["sw","nw","ne","se"]);var T=R().mousedown(v("move")).css({cursor:"move",position:"absolute",zIndex:360});return fe.support&&T.bind("touchstart.jcrop",fe.createDragger("move")),X.append(T),_(),{updateVisible:d,update:p,release:y,refresh:h,isAwake:function(){return x},setCursor:function(e){T.css("cursor",e)},enableHandles:w,enableOnly:function(){I=!0},showHandles:m,disableHandles:_,animMode:k,done:C}}(),pe=function(){function t(){ue.css({zIndex:450}),h&&e(document).bind("mousemove",i).bind("mouseup",o)}function n(){ue.css({zIndex:290}),h&&e(document).unbind("mousemove",i).unbind("mouseup",o)}function i(e){return c(l(e)),!1}function o(e){return e.preventDefault(),e.stopPropagation(),re&&(re=!1,f(l(e)),de.isAwake()&&H.onSelect.call(ve,b(he.getFixed())),n(),c=function(){},f=function(){}),!1}function r(e,n){return re=!0,c=e,f=n,t(),!1}function s(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,i(e)}function a(e){return e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,o(e)}function u(e){ue.css("cursor",e)}var c=function(){},f=function(){},h=H.trackDocument;return fe.support&&e(document).bind("touchmove",s).bind("touchend",a),h||ue.mousemove(i).mouseup(o).mouseout(o),J.before(ue),{activateHandlers:r,setCursor:u}}(),ge=function(){function t(){H.keySupport&&(r.show(),r.focus())}function n(e){r.hide()}function i(e,t,n){H.allowMove&&(he.moveOffset([t,n]),de.updateVisible()),e.preventDefault(),e.stopPropagation()}function o(e){if(e.ctrlKey)return!0;ae=e.shiftKey?!0:!1;var t=ae?10:1;switch(e.keyCode){case 37:i(e,-t,0);break;case 39:i(e,t,0);break;case 38:i(e,0,-t);break;case 40:i(e,0,t);break;case 27:de.release();break;case 9:return!0}return!1}var r=e('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}),s=e("<div />").css({position:"absolute",overflow:"hidden"}).append(r);return H.keySupport&&(r.keydown(o).blur(n),q||!H.fixedSupport?(r.css({position:"absolute",left:"-20px"}),s.append(r).insertBefore(J)):r.insertBefore(J)),{watchKeys:t}}();fe.support&&ue.bind("touchstart",fe.newSelection),V.hide(),F(!0);var ve={setImage:N,animateTo:S,setSelect:M,setOptions:E,tellSelect:O,tellScaled:T,setClass:j,disable:A,enable:P,cancel:z,release:de.release,destroy:D,focus:ge.watchKeys,getBounds:function(){return[Q*ie,U*oe]},getWidgetSize:function(){return[Q,U]},getScaleFactor:function(){return[ie,oe]},ui:{holder:K,selection:Y}};return e.browser.msie&&K.bind("selectstart",function(){return!1}),L.data("Jcrop",ve),ve},e.fn.Jcrop=function(t,n){function i(i){var o="object"==typeof t?t:{},r=o.useImg||i.src,s=new Image;s.onload=function(){function t(){var t=e.Jcrop(i,o);"function"==typeof n&&n.call(t)}function r(){s.width&&s.height?t():window.setTimeout(r,50)}window.setTimeout(r,50)},s.src=r}return this.each(function(){if(e(this).data("Jcrop")){if("api"===t)return e(this).data("Jcrop");e(this).data("Jcrop").setOptions(t)}else i(this)}),this},e.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:9,handleOffset:5,aspectRatio:0,keySupport:!0,cornerHandles:!0,sideHandles:!0,drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onRelease:function(){}}}(jQuery);